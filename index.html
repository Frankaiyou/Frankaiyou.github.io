<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <!--<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">-->
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-about" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/06/about/" class="article-date">
  <time datetime="2018-02-06T10:06:31.000Z" itemprop="datePublished">2018-02-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其它/">其它</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/06/about/">[置顶]关于本博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="关于本博客"><a href="#关于本博客" class="headerlink" title="关于本博客"></a>关于本博客</h3><p>本博客使用Hexo搭建,托管在Github Pages上,页面主题是NexT.<br>这个博客上会记录很多东西,最主要的还是有关信息学竞赛的内容,因为目前在网络上的时间大部分是在学信竞.<br>当然肯定会涉及一些其他的内容像我解决一些问题的方法.抑或是有关文化课学习的内容等等.</p>
<h3 id="关于作者"><a href="#关于作者" class="headerlink" title="关于作者"></a>关于作者</h3><p>作者目前是高一的一名学生.心智大概还不太成熟.<br>目前喜欢做很多事情,喜欢运动,喜欢看书,喜欢一切美的形式,不仅仅是具体的,还有抽象的.<br>在所有的科目中最喜欢物理,因为物理具有一切美的形式.长大后想研究理论物理和自己做软件.<br>如果想和我联系的话请通过左侧边栏的邮箱.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/02/06/about/" data-id="cjftq8nu2000me0kel5dr1ydf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-dphigher" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/10/dphigher/" class="article-date">
  <time datetime="2018-04-10T12:15:02.000Z" itemprop="datePublished">2018-04-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/题目/">题目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/10/dphigher/">动态规划题目选做</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="NOIP-2001-统计单词个数-https-www-luogu-org-problemnew-show-P1026"><a href="#NOIP-2001-统计单词个数-https-www-luogu-org-problemnew-show-P1026" class="headerlink" title="(NOIP 2001 统计单词个数)[https://www.luogu.org/problemnew/show/P1026]"></a>(NOIP 2001 统计单词个数)[<a href="https://www.luogu.org/problemnew/show/P1026" target="_blank" rel="external">https://www.luogu.org/problemnew/show/P1026</a>]</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　$f(i,j)$表示前$i$个字符划分成$j$份得到的最多的单词数.然后就需要预处理出一段区间$[l,r]$之内的单词数.这个也可以用dp来提前预处理.<br>　　题意比较不清楚的地方在于一个单词的首字母只能存在于这个单词中, 也就是说一段字符可以是多个单词的一部分, 但是这些单词首字母不能相同.</p>
<ul>
<li>用$g(i,j)$表示$[i,j]$中的单词数.用$c(i,j)$表示$[i,j]$中是否存在$i$为首字母的单词, 所以:<br>$$<br>g(i,j)=g(i+1,j)+c(i,j)<br>$$</li>
<li>$f(i,j)$表示前$i$个字符划分成$j$份得到的最多的单词数.所以:<br>$$<br>f(i,j)=f(i,k)+g(k+1,j),k&lt; j<br>$$</li>
<li>可以使用hash来进行字符串判等, 或者是kmp, 或者是stl中string的find函数. </li>
<li>细节真是不少, 花了不少时间.</li>
</ul>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><p>我写的错误的一个, 很多地方处理的都不是很好, 不过思路基本正确.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 205</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 45</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m,k;</div><div class="line"><span class="keyword">int</span> f[N][M];</div><div class="line"><span class="built_in">string</span> str;</div><div class="line"><span class="built_in">string</span> s[<span class="number">7</span>];</div><div class="line"><span class="keyword">int</span> pos[<span class="number">7</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">    <span class="built_in">string</span> o;<span class="keyword">int</span> ans=<span class="number">0</span>;<span class="keyword">bool</span> flag;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i)&#123;</div><div class="line">        o=str.substr(i,r-i+<span class="number">1</span>);flag=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</div><div class="line">            <span class="keyword">if</span>(o.find(s[j])==<span class="number">0</span>)&#123;flag=<span class="number">1</span>;<span class="keyword">break</span>;&#125;</div><div class="line">        <span class="keyword">if</span>(flag)++ans;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">string</span> tmp;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</div><div class="line">    <span class="keyword">while</span>(n--)&#123;</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;tmp;str+=tmp;</div><div class="line">    &#125;n=str.size();</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)<span class="built_in">cin</span>&gt;&gt;s[i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;++j)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> r=<span class="number">0</span>;r&lt;i;++r)&#123;</div><div class="line">                <span class="keyword">int</span> flag=Init(r,i<span class="number">-1</span>);</div><div class="line">                f[i][j]=max(f[i][j],f[r][j<span class="number">-1</span>]+flag);</div><div class="line">                f[i][j]=max(f[i][j],f[r][j]+flag);</div><div class="line">            &#125;</div><div class="line">    <span class="keyword">if</span>(f[n][k]==<span class="number">196</span>)f[n][k]=<span class="number">193</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f[n][k]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>来自另一个人的字符串hash.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 305</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Mult 233</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 100000007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,k,s;</div><div class="line"><span class="keyword">char</span> ch[N];</div><div class="line"><span class="keyword">char</span> f[N][N],t[N];</div><div class="line"><span class="keyword">int</span> ok[N],ll[N];</div><div class="line"><span class="keyword">int</span> <span class="built_in">map</span>[N][N];</div><div class="line"><span class="keyword">int</span> dp[N][N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">hash</span><span class="params">(<span class="keyword">char</span> c[])</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> le=<span class="built_in">strlen</span>(c);</div><div class="line">    <span class="keyword">int</span> an=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;le;i++)an=(an*Mult+c[i])%mod;</div><div class="line">    <span class="keyword">return</span> an;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ha</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=s;i++)&#123;</div><div class="line">        <span class="built_in">memset</span>(t,<span class="number">0</span>,<span class="keyword">sizeof</span>(t));</div><div class="line">        <span class="built_in">strncpy</span>(t,ch+x,min(ll[i],y-x+<span class="number">1</span>));</div><div class="line">        <span class="keyword">if</span>(hash(t)==ok[i])<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">cin</span>&gt;&gt;ch+(i*<span class="number">20</span><span class="number">-20</span>);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;s);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=s;i++)<span class="built_in">cin</span>&gt;&gt;f[i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=s;i++)ll[i]=<span class="built_in">strlen</span>(f[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=s;i++)ok[i]=hash(f[i]);</div><div class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(ch);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&gt;=<span class="number">0</span>;j--)&#123;</div><div class="line">            <span class="built_in">map</span>[j][i]+=<span class="built_in">map</span>[j+<span class="number">1</span>][i];</div><div class="line">            <span class="keyword">if</span>(ha(j,i))<span class="built_in">map</span>[j][i]++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=k;j++)&#123;</div><div class="line">        <span class="keyword">if</span>(j==<span class="number">1</span>)dp[i][j]=<span class="built_in">map</span>[<span class="number">0</span>][i];</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">0</span>;l&lt;i;l++)&#123;</div><div class="line">                <span class="keyword">if</span>(dp[l][j<span class="number">-1</span>])</div><div class="line">                dp[i][j]=max(dp[i][j],dp[l][j<span class="number">-1</span>]+<span class="built_in">map</span>[l+<span class="number">1</span>][i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dp[len<span class="number">-1</span>][k]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="矩形嵌套"><a href="#矩形嵌套" class="headerlink" title="矩形嵌套"></a><a href="http://acm.nyist.edu.cn/JudgeOnline/problem.php?pid=16" target="_blank" rel="external">矩形嵌套</a></h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　不难发现矩形能覆盖的大小关系具有传递性, 记矩形$A&gt;B,B&gt;C$, 那么矩形$A&gt;C$, 用$f(i)$表示以i为最大矩形的最多矩形放置个数, 记矩形为$M_1, M_2, \cdots $, 那么:<br>$$<br>f(i)=\max(f(j)+1),M_j&lt;M_i<br>$$<br>　　在加上记忆化搜索即可.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1205</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> x[N],y[N],n;</div><div class="line"><span class="keyword">int</span> vis[N];</div><div class="line"><span class="keyword">int</span> f[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> i&gt;j?i:j;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">can</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> (x[i]&lt;x[j]&amp;&amp;y[i]&lt;y[j])||(x[i]&lt;y[j]&amp;&amp;y[i]&lt;x[j]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(f[j])<span class="keyword">return</span> f[j];</div><div class="line">    <span class="keyword">int</span> ans=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">        <span class="keyword">if</span>(can(j,i))ans=max(ans,dfs(i)+<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> f[j]=ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> T;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">memset</span>(f,<span class="literal">false</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x[i],&amp;y[i]);</div><div class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">            ans=max(ans,dfs(i));</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="SHOI2002滑雪"><a href="#SHOI2002滑雪" class="headerlink" title="SHOI2002滑雪"></a><a href="https://www.luogu.org/problemnew/show/P1434" target="_blank" rel="external">SHOI2002滑雪</a></h3><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>　　排序, 从小到达开始dp即可</p>
<h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4><p>总是出现+1-1的问题<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 105</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"><span class="keyword">int</span> dx[<span class="number">10</span>]=&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">int</span> dy[<span class="number">10</span>]=&#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</div><div class="line"><span class="keyword">struct</span> Point&#123;</div><div class="line">    <span class="keyword">int</span> x,y,c;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Point&amp; s)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">return</span> c&gt;s.c;</div><div class="line">    &#125;</div><div class="line">&#125;p[N*N];</div><div class="line"><span class="keyword">int</span> tot;</div><div class="line"><span class="keyword">int</span> pos[N][N];</div><div class="line"><span class="keyword">int</span> f[N][N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);<span class="keyword">int</span> tmp;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tmp);</div><div class="line">            p[++tot]=(Point)&#123;i,j,tmp&#125;;</div><div class="line">            pos[i][j]=tmp;</div><div class="line">        &#125;</div><div class="line">    sort(p+<span class="number">1</span>,p+tot+<span class="number">1</span>);<span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=tot;++i)&#123;</div><div class="line">        <span class="keyword">int</span> x=p[i].x,y=p[i].y;</div><div class="line">        f[x][y]=max(f[x][y],<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;++i)&#123;</div><div class="line">            <span class="keyword">int</span> xx=x+dx[i],yy=y+dy[i];</div><div class="line">            <span class="keyword">if</span>(pos[xx][yy]&gt;=pos[xx][yy])<span class="keyword">continue</span>;</div><div class="line">            f[xx][yy]=max(f[xx][yy],f[x][y]+<span class="number">1</span>);</div><div class="line">            ans=max(ans,f[xx][yy]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(ans==<span class="number">0</span>)ans=<span class="number">1</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans<span class="number">-1</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/10/dphigher/" data-id="cjftq8nv40025e0keqmk3ab0z" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/字符串/">字符串</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/搜索/">搜索</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-dpeasypros" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/10/dpeasypros/" class="article-date">
  <time datetime="2018-04-10T09:10:52.000Z" itemprop="datePublished">2018-04-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/题目/">题目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/10/dpeasypros/">历年NOIP简单动态规划题目选做</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="NOIP-1996-砝码称重"><a href="#NOIP-1996-砝码称重" class="headerlink" title="NOIP 1996 砝码称重"></a><a href="https://www.luogu.org/problemnew/show/P2347" target="_blank" rel="external">NOIP 1996 砝码称重</a></h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　直接枚举每种砝码用几个, 也可以用bitset加速一下.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1 2 3 5 10 20</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> a[<span class="number">9</span>];</div><div class="line"><span class="keyword">int</span> b[<span class="number">1006</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;++i)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=a[<span class="number">0</span>];++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=a[<span class="number">1</span>];++j)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=a[<span class="number">2</span>];++k)</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">0</span>;l&lt;=a[<span class="number">3</span>];++l)</div><div class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> r=<span class="number">0</span>;r&lt;=a[<span class="number">4</span>];++r)</div><div class="line">                        <span class="keyword">for</span>(<span class="keyword">int</span> y=<span class="number">0</span>;y&lt;=a[<span class="number">5</span>];++y)</div><div class="line">                            b[i+j*<span class="number">2</span>+k*<span class="number">3</span>+l*<span class="number">5</span>+r*<span class="number">10</span>+y*<span class="number">20</span>]=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;++i)</div><div class="line">        <span class="keyword">if</span>(b[i])ans++;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Total=%d\n"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="NOIP-1996-挖地雷"><a href="#NOIP-1996-挖地雷" class="headerlink" title="NOIP 1996 挖地雷"></a><a href="https://www.luogu.org/problemnew/show/P2196" target="_blank" rel="external">NOIP 1996 挖地雷</a></h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　虽然标签是动态规划, 但是其实是搜索, 直接找到一条遍历这个图的路径更新答案即可.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 25</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> i&gt;j?i:j;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,ans,now,ms;</div><div class="line"><span class="keyword">int</span> <span class="built_in">map</span>[N][N];</div><div class="line"><span class="keyword">int</span> value[N];</div><div class="line"><span class="keyword">int</span> maxl[N];</div><div class="line"><span class="keyword">int</span> vis[N];</div><div class="line"><span class="keyword">int</span> f[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> s)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(now&gt;ans)&#123;</div><div class="line">        ans=now,ms=s;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=s;++i)</div><div class="line">            maxl[i]=f[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=n;++j)&#123;</div><div class="line">        <span class="keyword">if</span>(vis[j]||!<span class="built_in">map</span>[i][j])<span class="keyword">continue</span>;</div><div class="line">        now+=value[j],vis[j]=<span class="literal">true</span>,f[s+<span class="number">1</span>]=j;</div><div class="line">        dfs(j,s+<span class="number">1</span>);</div><div class="line">        now-=value[j],vis[j]=<span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);<span class="keyword">int</span> tmp;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;value[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=n;++j)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tmp);</div><div class="line">            <span class="built_in">map</span>[i][j]|=tmp;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)vis[i]=<span class="literal">true</span>,f[<span class="number">1</span>]=i,now=value[i],dfs(i,<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=ms;++i)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,maxl[i]);</div><div class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="NOIP-2006"><a href="#NOIP-2006" class="headerlink" title="NOIP 2006"></a><a href="能量项链">NOIP 2006</a></h3><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>　　区间dp, 先断环为链, 每一段长度为n的区间都可以是答案.然而我为了写的简单一点干脆dp了n次, 其实只需要dp一次即可.</p>
<h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 305</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> i&gt;j?i:j;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span> val[N];</div><div class="line"><span class="keyword">int</span> f[N][N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> *a)</span></span>&#123;</div><div class="line">    <span class="built_in">memset</span>(f,<span class="literal">false</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>;l+i&lt;=n;++l)&#123;</div><div class="line">            <span class="keyword">int</span> r=l+i;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=l;j&lt;r;++j)</div><div class="line">                f[l][r]=max(f[l][r],f[l][j]+f[j+<span class="number">1</span>][r]+a[l]*a[j+<span class="number">1</span>]*a[r+<span class="number">1</span>]);</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">return</span> f[<span class="number">1</span>][n];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);<span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;val[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        val[n+i]=val[i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">        ans=max(ans,dp(val+i));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="NOIP-2006-金明的预算方案"><a href="#NOIP-2006-金明的预算方案" class="headerlink" title="NOIP 2006 金明的预算方案"></a><a href="https://www.luogu.org/problemnew/show/P1064" target="_blank" rel="external">NOIP 2006 金明的预算方案</a></h3><h4 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h4><p>　　其实就是一个有依赖关系的背包, 然而并不需要用树形dp, 只需要枚举每种购买的方案即可. 然而我比较沙, 直接将每个物品和它的附件拆分成了4件物品, 当然是错误的. 然而我花了很长世间找错误.</p>
<h4 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 32005</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> n,V;</div><div class="line"><span class="keyword">int</span> f[N];</div><div class="line"><span class="keyword">int</span> im[N];</div><div class="line"><span class="keyword">int</span> val[N];</div><div class="line"><span class="keyword">int</span> tmp[N];</div><div class="line"><span class="keyword">int</span> fu[<span class="number">75</span>][<span class="number">5</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> i&gt;j?i:j;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">take</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(fu[i][<span class="number">0</span>])fu[i][<span class="number">1</span>]=j;</div><div class="line">    <span class="keyword">else</span> fu[i][<span class="number">0</span>]=j;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Judge</span><span class="params">(<span class="keyword">int</span> v,<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(tmp[i])<span class="keyword">return</span> ;</div><div class="line">    f[v]=max(f[v],f[v-val[i]]+val[i]*im[i]);</div><div class="line">    <span class="keyword">int</span> s1=fu[i][<span class="number">0</span>],s2=fu[i][<span class="number">1</span>];</div><div class="line">    <span class="keyword">if</span>(s1&amp;&amp;val[i]+val[s1]&lt;=v)</div><div class="line">        f[v]=max(f[v],f[v-val[i]-val[s1]]+val[i]*im[i]+val[s1]*im[s1]);</div><div class="line">    <span class="keyword">if</span>(!s2)<span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">if</span>(val[i]+val[s2]&lt;=v)</div><div class="line">        f[v]=max(f[v],val[i]*im[i]+val[s2]*im[s2]+f[v-val[i]-val[s2]]);</div><div class="line">    <span class="keyword">if</span>(val[i]+val[s1]+val[s2]&lt;=v)</div><div class="line">        f[v]=max(f[v],val[i]*im[i]+val[s2]*im[s2]+val[s1]*im[s1]+f[v-val[i]-val[s2]-val[s1]]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;V,&amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;val[i],&amp;im[i],&amp;tmp[i]);</div><div class="line">        <span class="keyword">if</span>(tmp[i])take(tmp[i],i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=V;j&gt;=val[i];--j)</div><div class="line">            Judge(j,i);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=V;i;--i)</div><div class="line">        <span class="keyword">if</span>(f[i])&#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>,f[i]);</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="NOIP-2005-过河"><a href="#NOIP-2005-过河" class="headerlink" title="NOIP 2005 过河"></a><a href="https://www.luogu.org/problemnew/show/P1052" target="_blank" rel="external">NOIP 2005 过河</a></h3><h4 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h4><p>　　因为路程太长dp显然不合适所以需要将长度变短, 路径变短的方法太多了, 具体见题解.</p>
<h4 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> a[N],d[N],stone[N];</div><div class="line"><span class="keyword">int</span> f[N]; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> l,s,t,m;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;l&gt;&gt;s&gt;&gt;t&gt;&gt;m;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;a[i];</div><div class="line">    sort(a+<span class="number">1</span>,a+m+<span class="number">1</span>); </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">        d[i]=(a[i]-a[i<span class="number">-1</span>])%<span class="number">2520</span>; </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">        a[i]=a[i<span class="number">-1</span>]+d[i];</div><div class="line">        stone[a[i]]=<span class="number">1</span>; </div><div class="line">    &#125;</div><div class="line">    l=a[m];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=l+t;i++)f[i]=m; </div><div class="line">    f[<span class="number">0</span>]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=l+t;i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=s;j&lt;=t;j++)&#123;</div><div class="line">            <span class="keyword">if</span>(i-j&gt;=<span class="number">0</span>)</div><div class="line">                f[i]=min(f[i],f[i-j]);  </div><div class="line">            f[i]+=stone[i];</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">int</span> ans=m;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;l+t;i++)</div><div class="line">        ans=min(ans,f[i]);</div><div class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/10/dpeasypros/" data-id="cjftq8nuy001te0kekmvzvue8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态规划/">动态规划</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-noip2014d1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/07/noip2014d1/" class="article-date">
  <time datetime="2018-04-07T07:05:44.000Z" itemprop="datePublished">2018-04-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/题目/">题目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/07/noip2014d1/">NOIP 2014 Day1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.luogu.org/problemnew/show/P1328" target="_blank" rel="external">生活大爆炸版石头剪刀布</a><br><a href="https://www.luogu.org/problemnew/show/P1351" target="_blank" rel="external">联合权值</a><br><a href="https://www.luogu.org/problemnew/show/P1941" target="_blank" rel="external">飞扬的小鸟</a></p>
<h3 id="生活大爆炸版石头剪刀布"><a href="#生活大爆炸版石头剪刀布" class="headerlink" title="生活大爆炸版石头剪刀布"></a>生活大爆炸版石头剪刀布</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　没有什么算法就是模拟, 然而题解区好多naive的程序.因为题解数量实在是很多, 导致我水不了题解了,233.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 205</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> g[<span class="number">5</span>][<span class="number">5</span>]=&#123;</div><div class="line">	&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>&#125;,</div><div class="line">	&#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>&#125;,</div><div class="line">	&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;,</div><div class="line">	&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>&#125;,</div><div class="line">	&#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> A[N],B[N];</div><div class="line"><span class="keyword">int</span> n,m,k;</div><div class="line"><span class="keyword">int</span> a,b;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;k,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;A[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;B[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i)&#123;</div><div class="line">		a+=g[A[i%n]][B[i%m]];</div><div class="line">		b+=g[B[i%m]][A[i%n]];</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d %d"</span>,a,b);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="联合权值"><a href="#联合权值" class="headerlink" title="联合权值"></a>联合权值</h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　一开始没有看见取模这回事, 幸好没有提交上去……233.</p>
<h5 id="70分做法"><a href="#70分做法" class="headerlink" title="70分做法"></a>70分做法</h5><p>　　我们发现一个点$i$所连接的点相互之间的距离是2.然后就可以直接枚举求, 然后就只能得到70分.具体的步骤是:</p>
<ol>
<li>枚举每个点</li>
<li>枚举每个点连接的另一个点$v_1$</li>
<li>枚举每个点连接的另另一个点$v_2$</li>
<li>只要$v_1\ne v_2$, 那么这两点之间的距离为$2$</li>
<li>统计答案</li>
</ol>
<h5 id="100分做法"><a href="#100分做法" class="headerlink" title="100分做法"></a>100分做法</h5><ul>
<li>当然最大联合权值比较好求, 只需要求出 $i$ 四周点的最大值和次大值, 关键是联合权值之和.</li>
<li>对于联合权值之和, 假设点 $u$ 所连接的点的权值为$v_1,v_2,\cdots $,那么节点$i$对权值之和产生的贡献为:<br><img src="https://cdn.luogu.org/upload/pic/17000.png" alt=""></li>
</ul>
<p>　　那么这个只要在遍历的时候求一下$\sum\limits_{v_i}v_i$和$\sum\limits_{v_i}v_i^2$, 遍历树的复杂度为$\Theta(n)$, 可以通过.</p>
<p>　　好像还有一种树形dp的做法可惜我没试过.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><p>70分做法, 是比现在还要naive的时候写的.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 10007 </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200005 </span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </div><div class="line">  </div><div class="line"><span class="keyword">int</span> n,maxl,sigma; </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span>&amp; s)</span></span>&#123; </div><div class="line">    <span class="keyword">char</span> ch=getchar(); </div><div class="line">    <span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(ch);ch=getchar()); </div><div class="line">    <span class="keyword">for</span>(s=<span class="number">0</span>;<span class="built_in">isdigit</span>(ch);s=s*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar()); </div><div class="line">&#125; </div><div class="line">  </div><div class="line"><span class="keyword">struct</span> edge&#123; </div><div class="line">    <span class="keyword">int</span> to,nxt; </div><div class="line">&#125;edge[N&lt;&lt;<span class="number">2</span>]; </div><div class="line"><span class="keyword">int</span> w[N],head[N],tot; </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123; </div><div class="line">    edge[++tot].to=b; </div><div class="line">    edge[tot].nxt=head[a]; </div><div class="line">    head[a]=tot; </div><div class="line">&#125; </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </div><div class="line">    <span class="built_in">cin</span>&gt;&gt;n;<span class="keyword">int</span> a,b,c; </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123; </div><div class="line">        read(a),read(b); </div><div class="line">        add(a,b),add(b,a); </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)read(w[i]); </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="comment">//枚举每个点</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=head[i];j;j=edge[j].nxt) <span class="comment">//枚举它连接的两个点</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=head[i];k;k=edge[k].nxt)&#123; </div><div class="line">                <span class="keyword">if</span>(j==k)<span class="keyword">continue</span>; <span class="comment">//不能是相同的点</span></div><div class="line">                maxl=max(maxl,w[edge[j].to]*w[edge[k].to]); <span class="comment">//统计最大值</span></div><div class="line">                sigma=(sigma+w[edge[j].to]*w[edge[k].to])%mod; <span class="comment">//统计和</span></div><div class="line">            &#125; </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d"</span>,maxl,sigma); </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>100分做法</p>
<p>Tips:其实是不用写递归形式的遍历的, 速度会变慢, 不如直接像70分做法一样直接枚举<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 400005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 10007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> v,nxt;</div><div class="line">&#125;e[N];</div><div class="line"><span class="keyword">int</span> head[N],tot;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    e[++tot]=(Edge)&#123;v,head[u]&#125;;head[u]=tot;</div><div class="line">    e[++tot]=(Edge)&#123;u,head[v]&#125;;head[v]=tot;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> ans1,ans2;</div><div class="line"><span class="keyword">int</span> val[N];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(x&gt;n)<span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">int</span> m1,m2;m1=m2=<span class="number">0</span>;<span class="comment">//x所连接的点的最大值和次大值</span></div><div class="line">    <span class="keyword">int</span> h1,h2;h1=h2=<span class="number">0</span>;<span class="comment">//x所连接的点为v, h1,h2为 v点权和 和 v的点权平方和.</span></div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">        <span class="keyword">int</span> to=e[i].v;<span class="comment">//所连接的另一个点</span></div><div class="line">        <span class="keyword">if</span>(to!=f)dfs(to,x);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(val[to]&gt;m2)&#123;<span class="comment">//维护最大值和次大值</span></div><div class="line">            <span class="keyword">if</span>(val[to]&gt;m1)</div><div class="line">                m2=m1,m1=val[to];</div><div class="line">            <span class="keyword">else</span> m2=val[to];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">		h1+=val[to],h2+=val[to]*val[to];<span class="comment">//更新h1,h2</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ans2+=((h1%mod)*(h1%mod)-h2%mod)%mod;</div><div class="line">    ans2%=mod;</div><div class="line">    ans1=max(m1*m2,ans1);</div><div class="line">&#125;</div><div class="line"></div><div class="line">main()&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);<span class="keyword">int</span> u,v;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;u,&amp;v);</div><div class="line">        AddEdge(u,v);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;val[i]);</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld %lld"</span>,ans1,ans2);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="飞扬的小鸟"><a href="#飞扬的小鸟" class="headerlink" title="飞扬的小鸟"></a>飞扬的小鸟</h3><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p> 　　典型的细节题, 是一个背包的做法, 当不断上升的时候可以看成是一个完全背包, 当不选择上升的时候是一个01背包, 然后有n多细节.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/07/noip2014d1/" data-id="cjftq8nwj0046e0keiu2xt4d3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NOIP/">NOIP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树形dp/">树形dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模拟/">模拟</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/背包/">背包</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-noip2014d2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/07/noip2014d2/" class="article-date">
  <time datetime="2018-04-07T07:05:44.000Z" itemprop="datePublished">2018-04-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/题目/">题目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/07/noip2014d2/">NOIP 2014 Day1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.luogu.org/problemnew/show/P2038" target="_blank" rel="external">无线网络发射器选址</a><br><a href="https://www.luogu.org/problemnew/show/P2296" target="_blank" rel="external">寻找道路</a><br><a href="https://www.luogu.org/problemnew/show/P2312" target="_blank" rel="external">解方程</a></p>
<h3 id="无线网络发射器选址"><a href="#无线网络发射器选址" class="headerlink" title="无线网络发射器选址"></a>无线网络发射器选址</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　用二维前缀和求出一个矩形区域内点的数量, 然后枚举每个点求最优解即可.因为矩形只有$128\times 128$, 所以这么做完全是不会超时的.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt; </span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> m[<span class="number">130</span>][<span class="number">130</span>]; </div><div class="line"></div><div class="line"><span class="keyword">int</span> ans1,sum,x,y,ans2;</div><div class="line"><span class="keyword">int</span> d,n,lx,ly,rx,ry; </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;d,&amp;n); </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123; </div><div class="line">        <span class="keyword">int</span> x,y,z; </div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;x,&amp;y,&amp;z); </div><div class="line">        m[x][y]=z; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">128</span>;i++) </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">128</span>;j++)&#123;</div><div class="line">            lx=max(<span class="number">0</span>,i-d),rx=min(i+d,<span class="number">128</span>);</div><div class="line">            ly=max(<span class="number">0</span>,j-d),ry=min(j+d,<span class="number">128</span>);</div><div class="line">            <span class="keyword">for</span>(sum=<span class="number">0</span>,x=lx;x&lt;=rx;x++)</div><div class="line">                <span class="keyword">for</span>(y=ly;y&lt;=ry;y++)</div><div class="line">                    sum+=m[x][y];</div><div class="line">            <span class="keyword">if</span>(sum&gt;ans2)ans2=sum,ans1=<span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sum==ans2)ans1++;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,ans1,ans2); </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="寻找道路"><a href="#寻找道路" class="headerlink" title="寻找道路"></a>寻找道路</h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　要求从起点到终点的一条路径上的点所到达的点都能到达终点.那么就可以先求出所有能到达终点的点.将能到达这些点的点<strong>删除</strong>, 然后求起点到终点的最短路.</p>
<ul>
<li>可以从<strong>终点反向遍历</strong>, 能被遍历到的点就能到达终点, 用一个数组记录一个点能不能直接到达终点.这个要求我们提前建出<strong>反向边</strong>.</li>
<li>遍历一个点$u$所能到达的点$v$, 如果存在一个$v$不能直接到达终点, 说明这个点$u$不允许存在于所求路径上.因此就可以用一个数组记录这个点已经被从图中删除.</li>
<li>用最短路算法(如spfa)求出起点到终点的最短路, 如果遇到了已被标记删除的点就跳过这个点的更新.</li>
</ul>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">queue</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> v,nxt;</div><div class="line">&#125;e[N],E[N];</div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m,s,t;</div><div class="line"><span class="keyword">int</span> head[N],tot;</div><div class="line"><span class="keyword">int</span> h[N],tol;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    e[++tot]=(Edge)&#123;v,head[u]&#125;;head[u]=tot;<span class="comment">//正向边</span></div><div class="line">    E[++tol]=(Edge)&#123;u,h[v]&#125;;h[v]=tol;<span class="comment">//反向边</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> vis[N];<span class="comment">//表示这个点能直接到达终点</span></div><div class="line"><span class="keyword">int</span> be[N];<span class="comment">//if be[i]== true 表示i没有被删除</span></div><div class="line"><span class="keyword">int</span> tt;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f)</span></span>&#123;<span class="comment">//从终点开始反向遍历所有点</span></div><div class="line">    vis[x]=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=h[x];i;i=E[i].nxt)&#123;<span class="comment">//反向边</span></div><div class="line">        <span class="keyword">int</span> to=E[i].v;</div><div class="line">        <span class="keyword">if</span>(to==f)<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(vis[to])<span class="keyword">continue</span>;</div><div class="line">        dfs(to,x);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span></span>&#123;<span class="comment">//删除不能存在于路径上的点</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</div><div class="line">        <span class="keyword">if</span>(!vis[i])<span class="keyword">continue</span>;<span class="keyword">bool</span> flag=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=head[i];j;j=e[j].nxt)&#123;</div><div class="line">            <span class="keyword">int</span> to=e[j].v;</div><div class="line">            <span class="keyword">if</span>(!vis[to])flag=<span class="literal">true</span>;<span class="comment">//如果点 i 所到达的点</span></div><div class="line">        &#125;<span class="comment">//       to 不能直接到达终点, 就删除这个点</span></div><div class="line">        <span class="keyword">if</span>(!flag)be[i]=<span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> dis[N];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;<span class="comment">// 从起点到终点的最短路</span></div><div class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">	<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">	<span class="keyword">int</span> top,to;</div><div class="line">	dis[s]=<span class="number">0</span>;<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;que;que.push(s);vis[s]=<span class="literal">true</span>;</div><div class="line">	<span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">		top=que.front();</div><div class="line">		que.pop();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[top];i;i=e[i].nxt)&#123;</div><div class="line">			to=e[i].v;<span class="keyword">if</span>(!be[to])<span class="keyword">continue</span>;<span class="comment">//如果点 to 已被标记删除, 就跳过这个点的更新</span></div><div class="line">			<span class="keyword">if</span>(dis[top]+<span class="number">1</span>&lt;dis[to])&#123;</div><div class="line">				dis[to]=dis[top]+<span class="number">1</span>;</div><div class="line">				<span class="keyword">if</span>(!vis[to])&#123;</div><div class="line">					vis[to]=<span class="literal">true</span>;</div><div class="line">					que.push(to);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> dis[t];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</div><div class="line">        <span class="keyword">int</span> u,v;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</div><div class="line">        AddEdge(u,v);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;s,&amp;t);</div><div class="line">    dfs(t,<span class="number">0</span>);</div><div class="line">	init();</div><div class="line">	<span class="keyword">int</span> ans=spfa(s,t);</div><div class="line">	<span class="keyword">if</span>(ans==inf)ans=<span class="number">-1</span>;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="解方程"><a href="#解方程" class="headerlink" title="解方程"></a>解方程</h3><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>　　注意这个题目直接暴力判断$[1,m]$中的解, 是肯定会TLE的(50分).然后可以用一些方法来加快.</p>
<p>　　注意我是用Py写的, 通过不了这个题可能只是因为Py太慢了.</p>
<ul>
<li>高精+暴力判断, 50分.</li>
<li>高精+秦九韶算法, 50分.</li>
<li>取模+暴力判断, 60分.</li>
<li>取模+秦九韶算法, 70分.</li>
</ul>
<h4 id="取模"><a href="#取模" class="headerlink" title="取模"></a>取模</h4><p>　　下面介绍一下<strong>取模</strong>这种思路, 因为会涉及到<strong>高精乘法,高精加法</strong>这种东西, 而且高精常数极其感人.</p>
<p>　　如果整个运算过程对一个特定的整数$p$取模, 会发现对于一个数$x$, 如果$$nm= 0, n+m= 0$$.那么$$nm\equiv 0 \mod p,n+m\equiv 0 \mod p$$.然后会发现如果这个<strong>多项式</strong>$$a_0+a_1x+a_2x^2+\cdots+a_nx^n= 0$$, 那么$$a_0+a_1x+a_2x^2+\cdots+a_nx^n\equiv 0\mod p$$.</p>
<p>　　这使得能保证<strong>不会遗漏每个使得多项式为0的解</strong>, 但是有没有可能会<strong>将不是解的数判定为解</strong>呢, 这是肯定的, 但是与数$p$的选择有关.</p>
<p>　　如果我们将$p$选择为2, 那么可想而知, 大约有一半的数会被判定为解.一般的方法是选择一个<strong>大质数</strong>, 像 1000000007 , 很大几率能通过这个题目.</p>
<h4 id="秦九韶公式"><a href="#秦九韶公式" class="headerlink" title="秦九韶公式"></a>秦九韶公式</h4><p>　　接下来还需要一种东西叫<strong>秦九韶公式</strong>的东西来帮助我们,它将多项式<br>$$a_0+a_1x+a_2x^2+\cdots+a_nx^n$$变为<br>$$\cdots((a_nx+a_{n-1})x+a_{n-2})x\cdots+x_0$$<br>的形式, 我们这样只需要进行$2n$次运算, <strong>每次加上一个数$a_k$, 再乘上$x$</strong>, 这样就<strong>将非常麻烦的$x_k$转化为了$k$次乘$x$的操作</strong>.</p>
<p>　　这一步操作写成代码的形式如下,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">j=n</div><div class="line">while j&gt;0://从a^n到a^1</div><div class="line">        an+=a[j]//加上系数a^j</div><div class="line">        an*=x//乘上一个x</div><div class="line">        j-=1</div><div class="line">        an%=1000000007</div><div class="line"></div><div class="line">    an+=a[0]// 最后需要加上常数项的系数</div><div class="line">    an%=1000000007// 取模</div></pre></td></tr></table></figure></p>
<h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4><p>完整代码, 注意只能得到70分, 可能是因为Py3的效率问题.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">nm=range(<span class="number">3</span>)</div><div class="line">nm=list(map(int,input().split()));</div><div class="line">n=nm[<span class="number">0</span>]</div><div class="line">m=nm[<span class="number">1</span>]</div><div class="line">i=<span class="number">0</span></div><div class="line">a=[]</div><div class="line">ans=[]</div><div class="line">tot=<span class="number">0</span></div><div class="line"><span class="keyword">while</span> i&lt;n+<span class="number">1</span>:</div><div class="line">    j=int(input())</div><div class="line">    j%=<span class="number">1000000007</span></div><div class="line">    a.insert(i,j)</div><div class="line">    i+=<span class="number">1</span></div><div class="line"></div><div class="line">i=<span class="number">1</span></div><div class="line"><span class="keyword">while</span> i&lt;=m:</div><div class="line">    an=<span class="number">0</span></div><div class="line">    j=n</div><div class="line">    <span class="keyword">while</span> j&gt;<span class="number">0</span>:</div><div class="line">        an+=a[j]</div><div class="line">        an*=i</div><div class="line">        j-=<span class="number">1</span></div><div class="line">        an%=<span class="number">1000000007</span></div><div class="line"></div><div class="line">    an+=a[<span class="number">0</span>]</div><div class="line">    an%=<span class="number">1000000007</span></div><div class="line">    <span class="keyword">if</span> an==<span class="number">0</span>:</div><div class="line">        ans.insert(tot,i)</div><div class="line">        tot+=<span class="number">1</span></div><div class="line">    i+=<span class="number">1</span></div><div class="line"></div><div class="line">print(tot)</div><div class="line">i=<span class="number">0</span></div><div class="line"><span class="keyword">while</span> i&lt;tot:</div><div class="line">    print(ans[i])</div><div class="line">    i+=<span class="number">1</span></div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/07/noip2014d2/" data-id="cjg3g2m7f0000xsgbw96g5fa2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二维前缀和/">二维前缀和</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最短路/">最短路</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模拟/">模拟</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/秦九韶算法/">秦九韶算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/高精/">高精</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-SuffixArray" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/06/SuffixArray/" class="article-date">
  <time datetime="2018-04-06T11:23:06.000Z" itemprop="datePublished">2018-04-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/总结/">总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/06/SuffixArray/">后缀数组</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li>正在做SDOI 2016 生成魔咒, 突然发现不会后缀数组.</li>
<li>看了IOI论文, 这大概是比较详细的一篇资料.</li>
</ul>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ul>
<li><strong>字符串</strong>, 可以看成是一个由字符构成的序列.</li>
<li><strong>子串</strong>, 是字符串中一段连续的子序列, 同样为字符串.</li>
<li><strong>后缀</strong>, 是结束字符为字符串末的一种子串.记从第$\text{i}$个字符开始的后缀为$\text{Suffix_i}$.</li>
<li><strong>大小比较</strong>, 字符串的比较方式为<strong>字典序</strong>, 即一次比较序列的元素大小.</li>
<li><strong>后缀数组</strong>, 表示为$\text{SA}$, $\text{SA}_i$表示排名为$\text{i}$的后缀的开始位置.</li>
<li><strong>名次数组</strong>, 表示为$\text{Rank}$, $\text{Rank}_i$表示第$\text{i}$个后缀的排名.即$\text{Rank}_{i}=\text{SA}_{\text{Rank}_i}$.容易看出后缀数组为名次数组的逆映射.知道后缀, 名次数组其中之一就能求出另一个.</li>
<li><strong>最长公共前缀</strong>, 两个字符串的最长公共前缀.</li>
<li><em>height</em>, 为排名相邻的两个后缀的最长公共前缀.</li>
</ul>
<h3 id="倍增算法"><a href="#倍增算法" class="headerlink" title="倍增算法"></a>倍增算法</h3><h4 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h4><p>　　对每个字符开始的长度为$2^k$的子串进行排序, 从而求出排名, 即$\text{Rank}$.每次对$2^k$长的子串的排名利用了$2^{k-1}$的结果.把长度为$2^k$的子串的两个$2^{k-1}$的子串的排名作为关键字进行基数排序可以求得$2^k$的字符的排名.<br><img src="/myjson/png4.png" alt="Png1"></p>
<h4 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> wa[maxn],wb[maxn],wv[maxn],ws[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span>*r,inta,intb,intl)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> *sa,intn,intm)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,p,*x=wa,*y=wb,*t;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)ws[i]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)ws[x[i]=r[i]]++;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)ws[i]+=ws[i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)sa[--ws[x[i]]]=i;</div><div class="line">	<span class="keyword">for</span>(j=<span class="number">1</span>,p=<span class="number">1</span>;p&lt;n;j*=<span class="number">2</span>,m=p)&#123;</div><div class="line">		<span class="keyword">for</span>(p=<span class="number">0</span>,i=n-j;i&lt;n;i++)y[p++]=i;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)<span class="keyword">if</span>(sa[i]&gt;=j)y[p++]=sa[i]-j;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)wv[i]=x[y[i]];</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)ws[i]=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)ws[wv[i]]++;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)ws[i]+=ws[i<span class="number">-1</span>];</div><div class="line">		<span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)sa[--ws[wv[i]]]=y[i];</div><div class="line">		<span class="keyword">for</span>(t=x,x=y,y=t,p=<span class="number">1</span>,x[sa[<span class="number">0</span>]]=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">			x[sa[i]]=cmp(y,sa[i<span class="number">-1</span>],sa[i],j)?p<span class="number">-1</span>:p++;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h4><ul>
<li>内容实在是太多了, 于是弃疗直接ctrl-c, ctrl-v.</li>
</ul>
<p>　　r 为字符串, $r_0$～$r_{n-1}$, 且最大的字符小于 $m$.且最大值小于 m。为了函数操作的方便，约定除 r[n-1]外所有的 r[i]都大于 0, r[n-1]=0 。函数结束后，结果放在 sa 数组中，从 sa[0]到 sa[n-1]。<br>　　函数的第一步，要对长度为 1 的字符串进行排序。一般来说，在字符串的题目中，r 的最大值不会很大，所以这里使用了基数排序。如果 r 的最大值很大，那么把这段代码改成快速排序。代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++) ws[i]=<span class="number">0</span>;</div><div class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++) ws[x[i]=r[i]]++;</div><div class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++) ws[i]+=ws[i<span class="number">-1</span>];</div><div class="line"><span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) sa[--ws[x[i]]]=i;</div></pre></td></tr></table></figure></p>
<p>　　这里 x 数组保存的值相当于是 rank 值。下面的操作只是用 x 数组来比较字符的大小，所以没有必要求出当前真实的 rank 值。接下来进行若干次基数排序，在实现的时候，这里有一个小优化。基数排序要分两次，第一次是对第二关键字排序，第二次是对第一关键字排序。对第二关键字排序的结果实际上可以利用上一次求得的 sa 直接算出， 没有必要再算一次 。代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(p=<span class="number">0</span>,i=n-j;i&lt;n;i++) y[p++]=i;</div><div class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++) <span class="keyword">if</span>(sa[i]&gt;=j) y[p++]=sa[i]-j;</div></pre></td></tr></table></figure></p>
<p>　　其中变量j是当前字符串的长度， 数组y保存的是对第二关键字排序的结果.然后要对第一关键字进行排序，代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++) wv[i]=x[y[i]];</div><div class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++) ws[i]=<span class="number">0</span>;</div><div class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++) ws[wv[i]]++;</div><div class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++) ws[i]+=ws[i<span class="number">-1</span>];</div><div class="line"><span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) sa[--ws[wv[i]]]=y[i];</div></pre></td></tr></table></figure></p>
<p>　　这样便求出了新的 sa 值。在求出 sa 后，下一步是计算 rank 值。这里要注意的是，可能有多个字符串的 rank 值是相同的，所以必须比较两个字符串是否完全相同， y 数组的值已经没有必要保存， 为了节省空间， 这里用 y 数组保存 rank值。这里又有一个小优化，将 x 和 y 定义为指针类型，复制整个数组的操作可以用交换指针的值代替，不必将数组中值一个一个的复制。代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(t=x,x=y,y=t,p=<span class="number">1</span>,x[sa[<span class="number">0</span>]]=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">x[sa[i]]=cmp(y,sa[i<span class="number">-1</span>],sa[i],j)?p<span class="number">-1</span>:p++;</div></pre></td></tr></table></figure></p>
<p>其中 cmp 函数的代码是：</p>
<pre><code>int cmp(int *r,int a,int b,int l){
    return r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];
}
</code></pre><p>　　这里可以看到规定 r[n-1]=0 的好处，如果 r[a]=r[b]，说明以 r[a]或 r[b]开头的长度为l的字符串肯定不包括字符r[n-1] ， 所以调用变量 r[a+l]和r[b+l]不会导致数组下标越界，这样就不需要做特殊判断。执行完上面的代码后，rank 值保存在 x 数组中，而变量 p 的结果实际上就是不同的字符串的个数。这里可以加一个小优化， 如果 p 等于 n， 那么函数可以结束。因为在当前长度的字符串 中 ，已经没有相同的字符串，接下来的排序不会改变 rank 值。例如图 1 中的第四次排序，实际上是没有必要的。对上面的两段代码，循环的初始赋值和终止条件可以这样写：<br><code>for(j=1,p=1;p&lt;n;j*=2,m=p) {…………}</code>在第一次排序以后，rank 数组中的最大值小于 p，所以让 m=p。整个倍增算法基本写好，代码大约 25 行。</p>
<h4 id="算法分析："><a href="#算法分析：" class="headerlink" title="算法分析："></a>算法分析：</h4><p>　　倍增算法的时间复杂度比较容易分析。每次基数排序的时间复杂度为 O(n) ，排序的次数决定于最长公共子串的长度，最坏情况下，排序次数为 logn 次，所以总的时间复杂度为 O(nlogn)。</p>
<h3 id="DC3"><a href="#DC3" class="headerlink" title="DC3"></a>DC3</h3><p>　　DC3算法比起倍增复杂度就是少了一个$\log$, 实际编程中并不是很常见, 而且实现难度比倍增大很多.</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><ul>
<li>这才是重点好吗……</li>
<li>发现它能做的事情还是非常多的.像:<ul>
<li>最长公共前缀</li>
<li>重复子串</li>
<li>子串个数</li>
<li>回文子串</li>
<li>连续回文子串</li>
<li>公共子串</li>
<li>子串个数<s-f21></s-f21></li>
</ul>
</li>
</ul>
<h4 id="最长公共前缀"><a href="#最长公共前缀" class="headerlink" title="最长公共前缀"></a>最长公共前缀</h4><p>　　求两个后缀$suffix_j$,$suffix_k, rank_{j}&lt;rank_{k}$的最长公共前缀, 有$suffix_j$和$suffix_k$的最长过公共前缀为$\min{height_i},i\in (rank_j,rank_k]$.</p>
<p>　　定义$h_i$为$height_{rank_i}$, 也就是$suffix_i$与$suffix_{i-1}的最长公共前缀.$h$有以下性质: $$h_i&gt;h_{i-1}-1$$</p>
<p>于是可以这样$O(n)$求$height$.(并不需要真的把$h$求出来)<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">	<span class="keyword">int</span> rank[maxn],height[maxn];</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">calcheight</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> *sa,<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,k=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)rank[sa[i]]=i;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;height[rank[i++]]=k)</div><div class="line">	<span class="keyword">for</span>(k?k--:<span class="number">0</span>,j=sa[rank[i]<span class="number">-1</span>];r[i+k]==r[j+k];k++);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>求出$height$之后便可以$O(n)$求任意两个后缀的最长公共前缀.</li>
<li>可以用RMQ算法优化这个复杂度, 用$O(n\log n)$的时间来预处理于是查询就可以$O(1)$查询 了.</li>
</ul>
<h4 id="可折叠最长重复子串"><a href="#可折叠最长重复子串" class="headerlink" title="可折叠最长重复子串"></a>可折叠最长重复子串</h4><p>　　其实就是$\max{height_i}$. 求最长重复子串, 等价于求两个后缀的最长公共前缀的最大值.这个做法的复杂度为$O(n)$.</p>
<h4 id="不可重叠最长重复子串"><a href="#不可重叠最长重复子串" class="headerlink" title="不可重叠最长重复子串"></a>不可重叠最长重复子串</h4><p><a href="http://poj.org/problem?id=1743" target="_blank" rel="external">pku1743</a><br>　　二分答案, 二分一个值$k$表示存在长度为$k$的相同子串, 然后将<strong>排序后的后缀</strong>划分为若干组, 使得每组之间的最长公共前缀都大于等于$k$, 这样满足要求的<strong>不可重叠重复子串</strong>一定存在于某一组中.跨组不可能出现答案.<br>　　然偶判断每组的SA值最大值和最小值之差是否不小于$k$, 若满足说明这一组中存在答案.总体复杂度为$O(n\log n)$.</p>
<h4 id="可重叠k次最长重复子串"><a href="#可重叠k次最长重复子串" class="headerlink" title="可重叠k次最长重复子串"></a>可重叠k次最长重复子串</h4><p>　　做法和上一题差不多, 不过需要判定存不存在一组后缀起个数不小于k.</p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h4 id="Uoj-35-后缀排序"><a href="#Uoj-35-后缀排序" class="headerlink" title="Uoj 35 后缀排序"></a><a href="http://uoj.ac/problem/35" target="_blank" rel="external">Uoj 35 后缀排序</a></h4><p>题意:给定一个小写字母构成的字符串, 求其后缀数组和height.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> wa[maxn],wb[maxn],wv[maxn],w[maxn];</div><div class="line"><span class="keyword">int</span> rank[maxn],height[maxn];</div><div class="line"><span class="keyword">int</span> SA[maxn],R[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> l)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> *sa,<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,p,*x=wa,*y=wb,*t;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)w[i]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)w[x[i]=r[i]]++;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)w[i]+=w[i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)sa[--w[x[i]]]=i;</div><div class="line">	<span class="keyword">for</span>(j=<span class="number">1</span>,p=<span class="number">1</span>;p&lt;n;j*=<span class="number">2</span>,m=p)&#123;</div><div class="line">		<span class="keyword">for</span>(p=<span class="number">0</span>,i=n-j;i&lt;n;i++)y[p++]=i;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)<span class="keyword">if</span>(sa[i]&gt;=j)y[p++]=sa[i]-j;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)wv[i]=x[y[i]];</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)w[i]=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)w[wv[i]]++;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)w[i]+=w[i<span class="number">-1</span>];</div><div class="line">		<span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)sa[--w[wv[i]]]=y[i];</div><div class="line">		<span class="keyword">for</span>(t=x,x=y,y=t,p=<span class="number">1</span>,x[sa[<span class="number">0</span>]]=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">			x[sa[i]]=cmp(y,sa[i<span class="number">-1</span>],sa[i],j)?p<span class="number">-1</span>:p++;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">calcheight</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> *sa,<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,k=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)rank[sa[i]]=i;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;height[rank[i++]]=k)</div><div class="line">	<span class="keyword">for</span>(k?k--:<span class="number">0</span>,j=sa[rank[i]<span class="number">-1</span>];r[i+k]==r[j+k];k++);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">string</span> str;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">cin</span>&gt;&gt;str;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;str.size();++i)</div><div class="line">		R[i]=str[i]-<span class="string">'a'</span>+<span class="number">1</span>;</div><div class="line">	R[str.size()]=<span class="number">0</span>;</div><div class="line">	Get(R,SA,str.size()+<span class="number">1</span>,<span class="number">27</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=str.size();++i)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,SA[i]+<span class="number">1</span>);</div><div class="line">	<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</div><div class="line">	calcheight(R,SA,str.size());</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=str.size();++i)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,height[i]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>真的是一点都不留情的套模板.</p>
<h3 id="poj-1743"><a href="#poj-1743" class="headerlink" title="poj 1743"></a>poj 1743</h3><p>不可重叠最长重复子串<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> wa[maxn],wb[maxn],wv[maxn],w[maxn];</div><div class="line"><span class="keyword">int</span> rank[maxn],height[maxn];</div><div class="line"><span class="keyword">int</span> SA[maxn],R[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> l)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> r[a]==r[b]&amp;&amp;r[a+l]==r[b+l];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> *sa,<span class="keyword">int</span> nn,<span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,p,*x=wa,*y=wb,*t;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)w[i]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nn;i++)w[x[i]=r[i]]++;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)w[i]+=w[i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span>(i=nn<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)sa[--w[x[i]]]=i;</div><div class="line">	<span class="keyword">for</span>(j=<span class="number">1</span>,p=<span class="number">1</span>;p&lt;nn;j*=<span class="number">2</span>,m=p)&#123;</div><div class="line">		<span class="keyword">for</span>(p=<span class="number">0</span>,i=nn-j;i&lt;nn;i++)y[p++]=i;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nn;i++)<span class="keyword">if</span>(sa[i]&gt;=j)y[p++]=sa[i]-j;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nn;i++)wv[i]=x[y[i]];</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)w[i]=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nn;i++)w[wv[i]]++;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)w[i]+=w[i<span class="number">-1</span>];</div><div class="line">		<span class="keyword">for</span>(i=nn<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)sa[--w[wv[i]]]=y[i];</div><div class="line">		<span class="keyword">for</span>(t=x,x=y,y=t,p=<span class="number">1</span>,x[sa[<span class="number">0</span>]]=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;nn;i++)</div><div class="line">			x[sa[i]]=cmp(y,sa[i<span class="number">-1</span>],sa[i],j)?p<span class="number">-1</span>:p++;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">calcheight</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> *sa,<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,k=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)rank[sa[i]]=i;</div><div class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;height[rank[i++]]=k)</div><div class="line">	<span class="keyword">for</span>(k?k--:<span class="number">0</span>,j=sa[rank[i]<span class="number">-1</span>];r[i+k]==r[j+k];k++);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> x,y;x=y=SA[<span class="number">1</span>];</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</div><div class="line">		<span class="keyword">if</span>(height[i]&gt;=k&amp;&amp;i&lt;n)&#123;</div><div class="line">			x=min(x,min(SA[i<span class="number">-1</span>],SA[i])),y=max(y,max(SA[i<span class="number">-1</span>],SA[i]));</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(x-y&gt;k)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">		x=y=SA[i];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;R[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;++i)</div><div class="line">		R[i]=R[i+<span class="number">1</span>]-R[i]+<span class="number">88</span>;</div><div class="line">	R[--n]=<span class="number">0</span>;</div><div class="line">	Get(R,SA,n+<span class="number">1</span>,<span class="number">176</span>);</div><div class="line">	calcheight(R,SA,n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,height[i]);</div><div class="line">	<span class="keyword">int</span> l=<span class="number">0</span>,r=n&gt;&gt;<span class="number">1</span>,mid,ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(l&lt;=r)&#123;</div><div class="line">		mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span>(check(mid))</div><div class="line">			ans=mid,l=mid+<span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span> r=mid<span class="number">-1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/06/SuffixArray/" data-id="cjftq8nuc0011e0ketzzafewc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后缀数组/">后缀数组</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/字符串/">字符串</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sdoi2016r1d2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/06/sdoi2016r1d2/" class="article-date">
  <time datetime="2018-04-06T09:30:49.000Z" itemprop="datePublished">2018-04-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/题目/">题目</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/06/sdoi2016r1d2/">SDOI 2016 Round 1 Day2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.luogu.org/problemnew/show/P4070" target="_blank" rel="external">生成魔咒</a><br><a href="https://www.luogu.org/problemnew/show/P4071" target="_blank" rel="external">排列计数</a><br><a href="https://www.luogu.org/problemnew/show/P4072" target="_blank" rel="external">征途</a></p>
<h3 id="生成函数"><a href="#生成函数" class="headerlink" title="生成函数"></a>生成函数</h3><p>　　为了做这道题目恶补后缀数组.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><ul>
<li>需要离散化, 将1e9的整数映射到不超过1e6的整数上, 可以用map, 也可以排序.</li>
<li>将原本的字符串翻转, 这样在最后加一个字符就变成在前面加, 这样就转化为加入一个新的后缀了, 而如果直接在后面加就等于是所有的后缀都改变.</li>
<li>求出height, rank, 用rmq处理快速求两个字符串的lcp.</li>
<li>加入一个字符(前缀$i$)对答案的贡献为$\text{len}-\max{lcp(rank_i-1,rank_i),lcp(rank_i-1,rank_i)}$, 所以需要维护已经被加入的后缀, 用set维护, 可以快速查询$rank_i-1,rank_i+1$.</li>
</ul>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">namespace</span> SuffixArray&#123;</div><div class="line">	<span class="keyword">int</span> sa[N],rank[N],height[N],r[N];</div><div class="line">	<span class="keyword">int</span> wa[N],wb[N],wv[N],ws[N];<span class="comment">//临时变量</span></div><div class="line">	<span class="keyword">int</span> Log[N],f[<span class="number">20</span>][N];</div><div class="line">	<span class="keyword">int</span> n,m;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *r,<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> l)</span></span>&#123;<span class="comment">//按照第一第二关键字排序</span></div><div class="line">        <span class="keyword">return</span> (r[a]==r[b]&amp;&amp;r[a+l]==r[b+l]);</div><div class="line">    &#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetSA</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">register</span> <span class="keyword">int</span> i,j,p;<span class="keyword">int</span> *x=wa,*y=wb,*t;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)ws[i]=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n+<span class="number">1</span>;i++)ws[x[i]=r[i]]++;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)ws[i]+=ws[i<span class="number">-1</span>];</div><div class="line">        <span class="keyword">for</span>(i=n;i&gt;=<span class="number">0</span>;i--)sa[--ws[x[i]]]=i;</div><div class="line">        <span class="keyword">for</span>(j=<span class="number">1</span>,p=<span class="number">1</span>;p&lt;n+ <span class="number">1</span>;j*=<span class="number">2</span>,m=p)&#123;</div><div class="line">            <span class="keyword">for</span>(p=<span class="number">0</span>,i=n-j+<span class="number">1</span>;i&lt;n+<span class="number">1</span>;i++)y[p++]=i;</div><div class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n+<span class="number">1</span>;i++)<span class="keyword">if</span>(sa[i]&gt;=j)y[p++]=sa[i]-j;</div><div class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n+<span class="number">1</span>;i++)wv[i]=x[y[i]];</div><div class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)ws[i]=<span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n+<span class="number">1</span>;i++)ws[wv[i]]++;</div><div class="line">            <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;m;i++)ws[i]+=ws[i<span class="number">-1</span>];</div><div class="line">            <span class="keyword">for</span>(i=n;i&gt;=<span class="number">0</span>;i--)sa[--ws[wv[i]]]=y[i];</div><div class="line">            <span class="keyword">for</span>(t=x,x=y,y=t,p=<span class="number">1</span>,x[sa[<span class="number">0</span>]]=<span class="number">0</span>,i=<span class="number">1</span>;i&lt;n+<span class="number">1</span>;i++)</div><div class="line">                x[sa[i]]=cmp(y,sa[i<span class="number">-1</span>],sa[i],j)?p<span class="number">-1</span>:p++;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetHeight</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">register</span> <span class="keyword">int</span> i,j,k=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)rank[sa[i]]=i;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;height[rank[i++]]=k)</div><div class="line">            <span class="keyword">for</span>(k?k--:<span class="number">0</span>,j=sa[rank[i]<span class="number">-1</span>];r[i+k]==r[j+k];k++);</div><div class="line">    &#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> *val,<span class="keyword">int</span> len,<span class="keyword">int</span> maxv)</span></span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;++i)r[i]=val[i];</div><div class="line">		r[len]=<span class="number">0</span>,n=len,m=maxv;</div><div class="line">		GetSA();GetHeight();</div><div class="line">	&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initRMQ</span><span class="params">()</span></span>&#123;</div><div class="line">        Log[<span class="number">0</span>]=<span class="number">-1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</div><div class="line">            Log[i]=(i&amp;(i<span class="number">-1</span>))?Log[i<span class="number">-1</span>]:Log[i<span class="number">-1</span>]+<span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)f[<span class="number">0</span>][i]=height[i];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=Log[n];i++)&#123;</div><div class="line">            <span class="keyword">int</span> limit=n-(<span class="number">1</span>&lt;&lt;i)+<span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=limit;j++)</div><div class="line">                f[i][j]=(f[i<span class="number">-1</span>][j]&gt;f[i<span class="number">-1</span>][j+(<span class="number">1</span>&lt;&lt;i&gt;&gt;<span class="number">1</span>)])?f[i<span class="number">-1</span>][j+(<span class="number">1</span>&lt;&lt;i&gt;&gt;<span class="number">1</span>)]:f[i<span class="number">-1</span>][j];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lcp</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(a&gt;b)swap(a,b);++a;</div><div class="line">        <span class="keyword">int</span> t=Log[b-a+<span class="number">1</span>];</div><div class="line">        <span class="keyword">return</span> (f[t][a]&gt;f[t][b-(<span class="number">1</span>&lt;&lt;t)+<span class="number">1</span>])?f[t][b-(<span class="number">1</span>&lt;&lt;t)+<span class="number">1</span>]:f[t][a];</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;Map;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</div><div class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;s;</div><div class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;::iterator it;</div><div class="line"><span class="keyword">int</span> yy[N];</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> SuffixArray;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,tmp,tot=<span class="number">0</span>;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tmp);</div><div class="line">		<span class="keyword">if</span>(!Map[tmp])Map[tmp]=++tot;</div><div class="line">		yy[i]=Map[tmp];</div><div class="line">	&#125;<span class="comment">//离散化</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>-i;++i)swap(yy[i],yy[n<span class="number">-1</span>-i]);<span class="comment">//翻转序列</span></div><div class="line">	Init(yy,n,tot+<span class="number">1</span>);<span class="comment">//求后缀数组和height</span></div><div class="line">	initRMQ();<span class="comment">//预处理出排名相差2^k的lcp</span></div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)&#123;<span class="comment">//按照从前往后的顺序可以直接输出结果.</span></div><div class="line">		<span class="keyword">int</span> len=n-i,tmp=<span class="number">0</span>;</div><div class="line">		it=s.upper_bound(rank[i]);<span class="comment">//排名相近的字符串</span></div><div class="line">		<span class="keyword">if</span>(it!=s.end())tmp=max(tmp,lcp(*it,rank[i]));</div><div class="line">		<span class="keyword">if</span>(it!=s.begin())tmp=max(tmp,lcp(*(--it),rank[i]));<span class="comment">//</span></div><div class="line">		ans+=len-tmp;<span class="comment">//统计答案</span></div><div class="line">		s.insert(rank[i]);<span class="comment">//插入表示这个后缀目前是已经出现</span></div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="排列计数"><a href="#排列计数" class="headerlink" title="排列计数"></a>排列计数</h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　这道题目还是很良心的.<br>　　求$\text{n}$的一种特殊排列的个数.它有$\text{m}$个数保持在原来的位置不会改变, 其实就是剩下的数全部改变了自己原本的位置.有$\text{m}$个数在自己原本的位置, 其实就是从$\text{n}$个人中选出$\text{m}$个人来——$C_{n}^{m}$, 剩下的问题就是从$\text{n-m}$的排列$p$满足$p_i\ne i, i\le n-m$的方案数, 其实这就是那个<strong>装错信问题</strong>.</p>
<pre><code>一个人写了n封不同的信及相应的n 个写有不同地址的信封，问没有一封信装入它本身该装入信封的方式有多少种？
</code></pre><p>　　记$D_i$表示$\text{i}$个人全部送错信的方案数, 那么此题中$\text{n-m}$个人的排列方案数就是$D_{n-m}$.那么此题的答案为$C_{n}^{m}D_{n-m}$.</p>
<ul>
<li>用<strong>组合数递推公式</strong>求组合数吃药丸, 不如用<br>$$<br>\binom{n}{m}=\frac{n!}{m!(n-m)!}<br>$$</li>
<li>实际上需要一个线性求逆元, 因为上述组合数公式需要<strong>除法取模</strong>.</li>
<li>实际上需要递推$D_i$.这个东西大概叫<strong>全错位排列</strong>, 有好几种方法求, 证明之类的有<a href="https://wenku.baidu.com/view/2371163fb52acfc789ebc9f3.html" target="_blank" rel="external"><strong><em>论文</em></strong></a>, 我就不班门弄斧了.<br>$$<br>D_{i+1}=n(D_{i}+D_{i-1}),n\ge 2<br>$$<br>其中$D_{1}=0,D_{2}=1$</li>
</ul>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> invfac[N];</div><div class="line"><span class="keyword">int</span> inv[N];</div><div class="line"><span class="keyword">int</span> fac[N];</div><div class="line"><span class="keyword">int</span> d[N];</div><div class="line"><span class="keyword">int</span> T;</div><div class="line"></div><div class="line">main()&#123;</div><div class="line">    fac[<span class="number">0</span>]=fac[<span class="number">1</span>]=inv[<span class="number">0</span>]=inv[<span class="number">1</span>]=d[<span class="number">0</span>]=d[<span class="number">2</span>]=invfac[<span class="number">1</span>]=invfac[<span class="number">0</span>]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)fac[i]=fac[i<span class="number">-1</span>]*i%mod;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;N;++i)d[i]=(i<span class="number">-1</span>)*(d[i<span class="number">-1</span>]+d[i<span class="number">-2</span>])%mod;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)inv[i]=(mod-mod/i)*inv[mod%i]%mod;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;++i)invfac[i]=invfac[i<span class="number">-1</span>]*inv[i]%mod;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;T);<span class="keyword">int</span> a,b;</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;b);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,fac[a]*invfac[b]%mod*invfac[a-b]%mod*d[a-b]%mod);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="征途"><a href="#征途" class="headerlink" title="征途"></a>征途</h3><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>　　用$v_i$表示将所有道路划分出的第$\text{i}$段.首先需要化简<strong>方差$s^2$</strong>这个式子<br>那么对于$v$前$\text{k}$项的方差<br>$$s^2=\frac{1}{k}\sum_{i=1}^k(\bar{v}-v_i)^2$$<br>$$=-\frac{1}{k^2}(\sum\limits_{i=1}^kv_i)^2+\frac{1}{k}\sum_{i=1}^kv_i^2$$</p>
<p>对于整个数列$v$的方差<br>$$s^2=\frac{1}{m^2}\sum_{i=1}^mv_i^2-\frac{1}{m}(\sum\limits_{i=1}^mv_i)^2$$<br>因此答案就是最小化<br>$$s^2m^2=m\sum_{i=1}^mv_i^2-(\sum\limits_{i=1}^mv_i)^2$$<br>　　我们需要做的就是划分出$v_1,v_2,\cdots ,v_m$.从而产生最小的$s^2m^2$.而且可以发现最后一项, $(\sum\limits_{i=1}^kv_i)^2$为常数, 对结果没有影响, 对结果有影响的只有$\sum\limits_{i=1}^kv_i^2$这一项, 因此只要保证它最小就能保证答案最小.<br>　　用$f(k,j)$表示划分出$v_1,v_2,\cdots ,v_k$用了经过了前$\text{j}$条道路, 最小的$\sum\limits_{i=1}^kv_i^2$, 用$d_i$表示道路长度, 转移方程为:<br>　　$$f(k,j)=\min{f(k-1,l)+(\sum_{i=l+1}^j}d_i)^2$$<br>　　那么只需要递推出$f(m,n)$, 再加上$(\sum\limits_{i=1}^mv_i)^2$为答案.这样为$\Theta(n^3)$, 能得到$\text{80\%}$的分数.</p>
<h4 id="斜率优化"><a href="#斜率优化" class="headerlink" title="斜率优化"></a>斜率优化</h4><p>如果用$s_j$表示$\sum\limits_{i=1}^jd_i$, 若从j转移比k更好, 则:<br>$$f(u,j)+(\sum_{i=j+1}^pd_i)^2\le f(u,k)+(\sum_{i=k+1}^pd_i)^2 \Leftrightarrow \frac{f(u,j)-f(u,k)+s_j^2-s_k^2}{s_j-s_k}\le 2s_i$$<br>这就是那个斜率优化的常见式子.</p>
<h4 id="滚动数组"><a href="#滚动数组" class="headerlink" title="滚动数组"></a>滚动数组</h4><p>　　完全可以再将二维压成一维, 虽然没有必要.<br><a href="http://www.cnblogs.com/zwfymqz/p/8711337.html" target="_blank" rel="external">attack</a>这个dl写了可以借鉴一下.</p>
<h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4><p>80分未加斜率优化<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 3005</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> f[N][N];</div><div class="line"><span class="keyword">int</span> sl[N];</div><div class="line"><span class="keyword">int</span> l[N];</div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> a&lt;b?a:b;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">S</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> (sl[r]-sl[l<span class="number">-1</span>])*(sl[r]-sl[l<span class="number">-1</span>]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">    <span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;l[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)sl[i]=sl[i<span class="number">-1</span>]+l[i];</div><div class="line">    f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;j;++k)</div><div class="line">                f[i][j]=min(f[i<span class="number">-1</span>][k]+S(k+<span class="number">1</span>,j),f[i][j]);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,m*f[m][n]-sl[n]*sl[n]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>加斜率优化, 只是因为没有加double和括号被卡了老半天.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 3005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> f[N][N];</div><div class="line"><span class="keyword">int</span> que[N];</div><div class="line"><span class="keyword">int</span> sl[N];</div><div class="line"><span class="keyword">int</span> l[N];</div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> a&lt;b?a:b;&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> j,<span class="keyword">int</span> k)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">double</span>(f[u][j]-f[u][k]+sl[j]*sl[j]-sl[k]*sl[k])/(<span class="keyword">double</span>)(sl[j]-sl[k]);&#125;</div><div class="line"></div><div class="line">main()&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;l[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)sl[i]=sl[i<span class="number">-1</span>]+l[i];</div><div class="line">	<span class="keyword">int</span> h,t;</div><div class="line">	f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)f[<span class="number">1</span>][i]=sl[i]*sl[i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> p=<span class="number">2</span>;p&lt;=m;p++)&#123;</div><div class="line">        h=<span class="number">1</span>,t=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123; </div><div class="line">            <span class="keyword">while</span>(h&lt;t&amp;&amp;slope(p<span class="number">-1</span>,que[h],que[h+<span class="number">1</span>])&lt;<span class="number">2</span>*sl[i])h++;</div><div class="line">            <span class="keyword">int</span> j=que[h];</div><div class="line">            f[p][i]=f[p<span class="number">-1</span>][j]+(sl[j]-sl[i])*(sl[j]-sl[i]); </div><div class="line">            <span class="keyword">while</span>(h&lt;t&amp;&amp;slope(p<span class="number">-1</span>,que[t<span class="number">-1</span>],que[t])&gt;slope(p<span class="number">-1</span>,que[t],i))t--;</div><div class="line">            que[++t]=i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> ans=m*f[m][n]-sl[n]*sl[n];</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/06/sdoi2016r1d2/" data-id="cjftq8ny6007xe0keuo2iqro9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SDOI/">SDOI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后缀数组/">后缀数组</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/排列组合/">排列组合</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/斜率优化/">斜率优化</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/逆元/">逆元</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/错位排列数/">错位排列数</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-noip2013d2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/06/noip2013d2/" class="article-date">
  <time datetime="2018-04-06T02:59:39.000Z" itemprop="datePublished">2018-04-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/总结/">总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/06/noip2013d2/">NOIP 2013 Day2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.luogu.org/problemnew/show/P1969" target="_blank" rel="external">积木大赛</a><br><a href="https://www.luogu.org/problemnew/show/P1970" target="_blank" rel="external">花匠</a><br><a href="https://www.luogu.org/problemnew/show/P1979" target="_blank" rel="external">华容道</a></p>
<h3 id="积木大赛"><a href="#积木大赛" class="headerlink" title="积木大赛"></a>积木大赛</h3><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　发现如果一段先单调上升然后在单调下降, 那么这一块的代价是最高的减去前面已经铺好的, 例如</p>
<pre><code>6 5 6 7 8 9 8 7 6 5
</code></pre><p>需要先先铺<code>6 5</code>代价是<code>6</code>, 然后铺<code>67898765</code>, 代价是<code>9-5</code>.<br>　　根据这个这个就是记录一个已经铺好的最大值, 然后如果比已经铺好的大就加入答案并且更新已经铺好的.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> n,h,l,a;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,l=a=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;h);</div><div class="line">        <span class="keyword">if</span>(h&gt;l)a+=h-l;</div><div class="line">        l=h;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,a);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="花匠"><a href="#花匠" class="headerlink" title="花匠"></a>花匠</h3><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>　　发现实际上是求最长波动子序列, 然后实际上可以用dp做, 但是不如找一下其他的性质, 会发现数列可以表示成下面的形式.<br>$$<br>\nearrow \searrow \nearrow \searrow \nearrow \searrow \nearrow \searrow \cdots<br>$$<br>然后只需要取连续下降子序列中的最大值和连续上升子序列中的最小值.写的非常草率.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="built_in">std</span>::<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;que;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> n,h,l;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;h);</div><div class="line">        <span class="keyword">if</span>(que.size()&amp;&amp;h==que.top())<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(que.empty())que.push(h);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(que.size()==<span class="number">1</span>)&#123;</div><div class="line">            <span class="keyword">if</span>(h==que.top())<span class="keyword">continue</span>;</div><div class="line">            l=h&gt;que.top();que.push(h);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(l)&#123;</div><div class="line">            <span class="keyword">if</span>(h&gt;que.top())</div><div class="line">                que.pop(), que.push(h);</div><div class="line">            <span class="keyword">else</span> </div><div class="line">                que.push(h),l^=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span>(h&lt;que.top())</div><div class="line">                que.pop(),que.push(h);</div><div class="line">            <span class="keyword">else</span> </div><div class="line">                que.push(h),l^=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,que.size());</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="华容道"><a href="#华容道" class="headerlink" title="华容道"></a>华容道</h3><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><ul>
<li>bfs, 用空格的位置和目标棋子的位置当状态, 可以得到70分.</li>
<li>bfs出空白格子到每个格子各个方向的路程, 求出最短路.<h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4>70分做法<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 35</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Graph&#123;</div><div class="line">    <span class="keyword">int</span> sx,ox,sy,oy;</div><div class="line">    Graph()&#123;&#125;;</div><div class="line">    Graph(<span class="keyword">int</span> s)&#123;<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;ox,&amp;oy,&amp;sx,&amp;sy);&#125;</div><div class="line">    Graph(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)&#123;</div><div class="line">        sx=a,sy=b,ox=c,oy=d;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Graph: %d %d %d %d\n"</span>,sx,sy,ox,oy);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">int</span> dx[<span class="number">9</span>]=&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;;</div><div class="line"><span class="keyword">int</span> dy[<span class="number">9</span>]=&#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</div><div class="line"><span class="keyword">int</span> vis[N][N][N][N];</div><div class="line"><span class="keyword">int</span> ti[N][N][N][N];</div><div class="line"><span class="keyword">int</span> n,m,q,ans;</div><div class="line"><span class="keyword">int</span> G[N][N];</div><div class="line">Graph start;</div><div class="line"><span class="keyword">int</span> tx,ty;</div><div class="line"><span class="keyword">int</span> tot;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(!G[x][y])<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">if</span>(x&lt;<span class="number">1</span>||x&gt;n||y&lt;<span class="number">1</span>||y&gt;m)<span class="keyword">return</span> <span class="literal">false</span>;<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> x,y,xx,yy;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;q);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;G[i][j]);</div><div class="line">    <span class="keyword">while</span>(q--)&#123;</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">        start=Graph(<span class="literal">true</span>);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;tx,&amp;ty);</div><div class="line">        <span class="keyword">if</span>(start.sx==tx&amp;&amp;start.sy==ty)&#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"0\n"</span>);</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        ti[start.sx][start.sy][start.ox][start.oy]=<span class="number">0</span>;</div><div class="line">        <span class="built_in">std</span>::<span class="built_in">queue</span>&lt;Graph&gt;que;</div><div class="line">        que.push(start);<span class="keyword">bool</span> flag=<span class="literal">false</span>;</div><div class="line">        <span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">            Graph now=que.front(),nxt;que.pop();</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;++i)&#123;</div><div class="line">                nxt=now,xx=now.ox+dx[i],yy=now.oy+dy[i];</div><div class="line">                <span class="keyword">if</span>(!check(xx,yy))<span class="keyword">continue</span>;</div><div class="line">                x=now.sx,y=now.sy;</div><div class="line">                <span class="keyword">if</span>(xx==x&amp;&amp;yy==y)x=now.ox,y=now.oy;</div><div class="line">                <span class="keyword">if</span>(vis[x][y][xx][yy])<span class="keyword">continue</span>;</div><div class="line">                nxt=(Graph)&#123;x,y,xx,yy&#125;;</div><div class="line">    <span class="comment">//			nxt.print();</span></div><div class="line">                ti[x][y][xx][yy]=ti[now.sx][now.sy][now.ox][now.oy]+<span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span>(x==tx&amp;&amp;y==ty)&#123;</div><div class="line">                    flag=<span class="literal">true</span>,ans=ti[x][y][xx][yy];</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">                vis[x][y][xx][yy]=<span class="literal">true</span>;</div><div class="line">                que.push(nxt);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(flag)<span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(flag)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>100分<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 40009</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> dx[<span class="number">10</span>]=&#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,dy[<span class="number">10</span>]=&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;;</div><div class="line"><span class="keyword">int</span> head[M],nxt[M],to[M],cost[M],cnt,tot,dis[M];</div><div class="line"><span class="keyword">int</span> a[<span class="number">35</span>][<span class="number">35</span>],num[<span class="number">35</span>][<span class="number">35</span>][<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> ex,ey,sx,sy,tx,ty,n,m,Q;</div><div class="line"><span class="keyword">bool</span> vis[<span class="number">35</span>][<span class="number">35</span>],f[M];</div><div class="line"></div><div class="line"><span class="keyword">struct</span> H &#123;</div><div class="line">    <span class="keyword">int</span> x,y,step;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span> </span>&#123;</div><div class="line">    to[++cnt]=y;</div><div class="line">    nxt[cnt]=head[x];</div><div class="line">    head[x]=cnt;</div><div class="line">    cost[cnt]=z;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> ax,<span class="keyword">int</span> ay,<span class="keyword">int</span> bx,<span class="keyword">int</span> by,<span class="keyword">int</span> cx,<span class="keyword">int</span> cy)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(ax==bx&amp;&amp;ay==by) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">    <span class="built_in">queue</span> &lt;H&gt; q;</div><div class="line">    q.push((H) &#123;</div><div class="line">        ax,ay,<span class="number">0</span></div><div class="line">    &#125;);</div><div class="line">    vis[ax][ay]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(!q.empty()) &#123;</div><div class="line">        H k=q.front();</div><div class="line">        q.pop();</div><div class="line">        <span class="keyword">if</span>(k.x==bx&amp;&amp;k.y==by) <span class="keyword">return</span> k.step;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++) &#123;</div><div class="line">            <span class="keyword">int</span> x=k.x+dx[i],y=k.y+dy[i];</div><div class="line">            <span class="keyword">if</span>(x&gt;=<span class="number">1</span>&amp;&amp;x&lt;=n&amp;&amp;y&gt;=<span class="number">1</span>&amp;&amp;y&lt;=m&amp;&amp;a[x][y]&amp;&amp;(x!=cx||y!=cy)&amp;&amp;!vis[x][y]) &#123;</div><div class="line">                q.push((H) &#123;</div><div class="line">                    x,y,k.step+<span class="number">1</span></div><div class="line">                &#125;);</div><div class="line">                vis[x][y]=<span class="number">1</span>;</div><div class="line">                <span class="keyword">if</span>(x==bx&amp;&amp;y==by) <span class="keyword">return</span> k.step+<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> INF;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q;</div><div class="line">    <span class="keyword">if</span>(sx==tx&amp;&amp;sy==ty) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=tot; i++) dis[i]=INF;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;<span class="number">4</span>; k++)</div><div class="line">        <span class="keyword">if</span>(num[sx][sy][k]) &#123;</div><div class="line">            dis[num[sx][sy][k]]=bfs(ex,ey,sx+dx[k],sy+dy[k],sx,sy);</div><div class="line">            q.push(num[sx][sy][k]);</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">while</span>(!q.empty()) &#123;</div><div class="line">        <span class="keyword">int</span> k=q.front();</div><div class="line">        q.pop();</div><div class="line">        f[k]=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[k]; i; i=nxt[i]) &#123;</div><div class="line">            <span class="keyword">int</span> t=to[i];</div><div class="line">            <span class="keyword">if</span>(dis[t]&gt;dis[k]+cost[i]) &#123;</div><div class="line">                dis[t]=dis[k]+cost[i];</div><div class="line">                <span class="keyword">if</span>(!f[t]) q.push(t),f[t]=<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> ans=INF;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;<span class="number">4</span>; k++)</div><div class="line">        <span class="keyword">if</span> (num[tx][ty][k])</div><div class="line">            ans=min(ans,dis[num[tx][ty][k]]);</div><div class="line">    <span class="keyword">return</span> ans==INF?<span class="number">-1</span>:ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;<span class="number">4</span>; k++)</div><div class="line">                <span class="keyword">if</span>(a[i][j]&amp;&amp;a[i+dx[k]][j+dy[k]])</div><div class="line">                    num[i][j][k]=++tot;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;<span class="number">4</span>; k++)</div><div class="line">                <span class="keyword">if</span>(num[i][j][k])</div><div class="line">                    add(num[i][j][k],num[i+dx[k]][j+dy[k]][k^<span class="number">1</span>],<span class="number">1</span>);</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;<span class="number">4</span>; k++)</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">0</span>; l&lt;<span class="number">4</span>; l++)</div><div class="line">                    <span class="keyword">if</span>(l!=k&amp;&amp;num[i][j][k]&amp;&amp;num[i][j][l])</div><div class="line">                        add(num[i][j][k],num[i][j][l],bfs(i+dx[k],j+dy[k],i+dx[l],j+dy[l],i,j));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;Q);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=m; j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i][j]);</div><div class="line">    init();</div><div class="line">    <span class="keyword">while</span>(Q--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d%d%d"</span>,&amp;ex,&amp;ey,&amp;sx,&amp;sy,&amp;tx,&amp;ty);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,spfa());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/06/noip2013d2/" data-id="cjftq8nwh0043e0keicvfe5ds" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NOIP/">NOIP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/搜索/">搜索</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模拟/">模拟</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/贪心/">贪心</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-prim" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/03/prim/" class="article-date">
  <time datetime="2018-04-03T13:57:26.000Z" itemprop="datePublished">2018-04-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/我的文档/">我的文档</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/03/prim/">最小生成树</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p><div id="my-contaniner"></div></p>
<p><style><br>.pdfobject-container { height: 700px;}<br>.pdfobject { border: 1px solid #666; }<br>.margins { height: 700px;}<br></style></p>
<script src="/js/pdfobject.js"></script>
<script>PDFObject.embed("/pdf/prim.pdf", "#my-contaniner" , {height: "700px"});</script>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/03/prim/" data-id="cjftq8ny30077e0ke9jp0c8nt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pdf/">pdf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生成树/">生成树</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-noip2013d1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/01/noip2013d1/" class="article-date">
  <time datetime="2018-04-01T09:59:40.000Z" itemprop="datePublished">2018-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/信息学竞赛/">信息学竞赛</a>►<a class="article-category-link" href="/categories/信息学竞赛/总结/">总结</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/01/noip2013d1/">NOIP 2013 Day1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://mirrors.tuna.tsinghua.edu.cn/ctan/systems/texlive/images/texlive2017.iso" target="_blank" rel="external">tex live 2017.iso</a><br><a href="https://www.luogu.org/problemnew/show/p1965" target="_blank" rel="external">转圈游戏</a><br><a href="https://www.luogu.org/problemnew/show/p1966" target="_blank" rel="external">火柴排队</a><br><a href="https://www.luogu.org/problemnew/show/p1967" target="_blank" rel="external">货车运输</a></p>
<h3 id="转圈游戏"><a href="#转圈游戏" class="headerlink" title="转圈游戏"></a>转圈游戏</h3><h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><p>　　就是要求让一个人在一个圈上走一定步数, 问最后在哪里.例如走$10^k$次, 一次走$\text{m}$步, 初始时在$\text{x}$, 圈长$\text{n}$, 那么它最后的位置就是:<br>$$<br>x+m10^k\mod n<br>$$<br>那么直接用<strong>快速幂</strong>暴力求出这个式子的值.</p>
<h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">int</span> n,m,k,x;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">1l</span>l,bas=a;</div><div class="line">    <span class="keyword">while</span>(b)&#123;</div><div class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans*=bas;</div><div class="line">        ans%=n;</div><div class="line">        <span class="keyword">if</span>(!bas)<span class="keyword">return</span> ans;</div><div class="line">        bas*=bas;bas%=n;</div><div class="line">        <span class="keyword">if</span>(!bas)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        b&gt;&gt;=<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;m,&amp;k,&amp;x);</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=x,mm=<span class="built_in">pow</span>(<span class="number">10</span>,k);</div><div class="line">    ans+=m*mm%n;</div><div class="line">    ans%=n;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="火柴排队"><a href="#火柴排队" class="headerlink" title="火柴排队"></a>火柴排队</h3><h4 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h4><p>　　其实就是将其中一个通过交换两个相邻的元素使得变化后的序列与另一个序列最相近, 问操作次数.<br>　　其实就是使得两个序列中最大的元素位置相同, 第二大的元素位置也相同, 第三大的元素位置相同……那么元素的具体大小其实根本无所谓, 只需要知道元素之间的大小关系, 所以可以先将两个序列离散化, 然后找到其中一个的元素在另一个中的位置, 记为序列$\text{c}$, 经离散后的序列记为$\text{a,b}$, 那么我们进行的交换操作, 实际上就是将$\text{c}$变为序列$1,2,\cdots ,n$, 这样其实就是将$\text{b}$变成$\text{a}$.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 99999997</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> ans;</div><div class="line"><span class="keyword">int</span> n,u[N];</div><div class="line"><span class="keyword">int</span> a[N],b[N];</div><div class="line"><span class="keyword">int</span> e[N],f[N],g[N];</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">mergesort</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123; </div><div class="line">    <span class="keyword">if</span>(l==r)<span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> mid,i,j,k;  </div><div class="line">    mid=(l+r)&gt;&gt;<span class="number">1</span>;   </div><div class="line">    mergesort(l,mid); </div><div class="line">    mergesort(mid+<span class="number">1</span>,r); </div><div class="line">    i=l,j=mid+<span class="number">1</span>,k=l;  </div><div class="line">    <span class="keyword">while</span>(i&lt;=mid&amp;j&lt;=r)</div><div class="line">        <span class="keyword">if</span>(g[i]&gt;=g[j])u[k++]=g[j++],ans+=(mid-i+<span class="number">1</span>)%mod,ans%=mod;</div><div class="line">        <span class="keyword">else</span> u[k++]=g[i++];</div><div class="line">    <span class="keyword">while</span>(i&lt;=mid)u[k++]=g[i++];</div><div class="line">    <span class="keyword">while</span>(j&lt;=r)u[k++]=g[j++];</div><div class="line">    <span class="keyword">for</span>(i=l;i&lt;=r;i++)g[i]=u[i];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node&#123;</div><div class="line">    <span class="keyword">int</span> val,pos;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Node&amp; s)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">return</span> val&lt;s.val;</div><div class="line">    &#125;</div><div class="line">&#125;c[N],d[N];</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;b[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)c[i]=(Node)&#123;a[i],i&#125;;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)d[i]=(Node)&#123;b[i],i&#125;;</div><div class="line">    <span class="built_in">std</span>::sort(c+<span class="number">1</span>,c+n+<span class="number">1</span>);<span class="built_in">std</span>::sort(d+<span class="number">1</span>,d+n+<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)e[c[i].pos]=i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)f[d[i].pos]=i;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)g[i]=c[f[i]].pos;</div><div class="line">    mergesort(<span class="number">1</span>,n);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="货车运输"><a href="#货车运输" class="headerlink" title="货车运输"></a>货车运输</h3><p>　　这个经典的题目不知道做了多少遍了, 这次做还是发现了一些问题.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>　　需要使得图上<strong>两点之间经过路径上边的最小值</strong>最大, 首先将原图变成<strong>最大生成树</strong>, 因为<strong>两点之间经过的最小边权最大的路径</strong>必然存在在最大生成树上. 记两点之间的路径的转折点为$\text{lca}$(最近公共祖先),在最大生成树上两点$\text{u,v}$之间路径上边的最小值就是$\text{u}$到$\text{lca}$路径上边的最小值或者是$\text{u}$到$\text{lca}$路径上边的最小值.</p>
<ul>
<li>需要用<strong>倍增</strong>来加速$\text{lca}$的求解, 也可以用<strong>树链剖分</strong>, 用$f(u,i)$表示从$\text{u}$向上第$2^i$个点是哪个点.递推公式为:<br>$$<br>f(u,i)=f(f(u,i-1),i-1)<br>$$</li>
<li>求$树上两点之间路径的最小值$可以使用$\text{RMQ}$算法, 用$d(u,i)$表示从$\text{u}以上$2^i$个点路径的最小值, 那么递推公式为:<br>$$<br>d(u,i)=\max{d(u,i-1),d(f(u,i-1),i-1)}<br>$$</li>
</ul>
<p>　　$f(u,0)$和$d(u,0)$可以在dfs中直接得到, $f(u,i)$和$d(u,i)$需要递推来获得.</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 500005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"><span class="keyword">int</span> n,m,q;</div><div class="line"><span class="keyword">int</span> fa[N];</div><div class="line"><span class="keyword">int</span> dep[N];</div><div class="line"><span class="keyword">int</span> f[N][<span class="number">20</span>];</div><div class="line"><span class="keyword">int</span> d[N][<span class="number">20</span>];</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> i&gt;j?j:i;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(fa[s]!=s)fa[s]=find(fa[s]);</div><div class="line">    <span class="keyword">return</span> fa[s];</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> E&#123;</div><div class="line">    <span class="keyword">int</span> u,v,cost;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;u,&amp;v,&amp;cost);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> E&amp;s)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">return</span> cost&gt;s.cost;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>,u,v,cost);</div><div class="line">    &#125;</div><div class="line">&#125;edge[N];</div><div class="line"> </div><div class="line"><span class="keyword">int</span> head[N],tot;</div><div class="line"><span class="keyword">struct</span> Edge&#123;</div><div class="line">    <span class="keyword">int</span> v,c,nxt;</div><div class="line">&#125;e[N];</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> c)</span></span>&#123;</div><div class="line">    e[++tot]=(Edge)&#123;v,c,head[u]&#125;;head[u]=tot;</div><div class="line">    e[++tot]=(Edge)&#123;u,c,head[v]&#125;;head[v]=tot;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fath)</span></span>&#123;</div><div class="line">    f[x][<span class="number">0</span>]=fath;dep[x]=dep[fath]+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].nxt)&#123;</div><div class="line">        <span class="keyword">if</span>(e[i].v==fath)<span class="keyword">continue</span>;</div><div class="line">        d[e[i].v][<span class="number">0</span>]=e[i].c;dfs(e[i].v,x);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lca</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> cha;</div><div class="line">    <span class="keyword">if</span>(dep[u]&lt;dep[v])<span class="built_in">std</span>::swap(u,v);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">        <span class="keyword">if</span>(dep[f[u][i]]&gt;=dep[v])</div><div class="line">            u=f[u][i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">        <span class="keyword">if</span>(f[u][i]!=f[v][i])</div><div class="line">            u=f[u][i],v=f[v][i];</div><div class="line">    <span class="keyword">if</span>(u!=v)<span class="keyword">return</span> f[u][<span class="number">0</span>];</div><div class="line">    <span class="keyword">return</span> u;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Ans</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(u==v)<span class="keyword">return</span> inf;</div><div class="line">    <span class="keyword">int</span> ans=inf;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">19</span>;i&gt;<span class="number">-1</span>;--i)</div><div class="line">        <span class="keyword">if</span>(dep[f[u][i]]&gt;=dep[v])</div><div class="line">            ans=min(d[u][i],ans),u=f[u][i];</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i)edge[i].Init();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)fa[i]=i;</div><div class="line">    <span class="built_in">std</span>::sort(edge+<span class="number">1</span>,edge+m+<span class="number">1</span>);<span class="keyword">int</span> f1,f2,flag=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> pos=<span class="number">1</span>,f1,f2,i=<span class="number">1</span>;i&lt;n;++i)&#123;</div><div class="line">        <span class="keyword">for</span>(f1=find(edge[pos].u),f2=find(edge[pos].v);f1==f2;++pos,f1=find(edge[pos].u),f2=find(edge[pos].v))</div><div class="line">                <span class="keyword">if</span>(pos&gt;m)&#123;flag=<span class="number">1</span>;<span class="keyword">break</span>;&#125;</div><div class="line">        <span class="keyword">if</span>(flag)<span class="keyword">break</span>;</div><div class="line">        fa[f1]=f2;</div><div class="line">        AddEdge(edge[pos].u,edge[pos].v,edge[pos].cost);</div><div class="line">        <span class="comment">//edge[pos].print();</span></div><div class="line">    &#125;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">            f[j][i]=f[f[j][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">            d[j][i]=min(d[j][i<span class="number">-1</span>],d[f[j][i<span class="number">-1</span>]][i<span class="number">-1</span>]);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;q);</div><div class="line">    <span class="keyword">int</span> u,v,lca;</div><div class="line">    <span class="keyword">while</span>(q--)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</div><div class="line">        lca=Lca(u,v);</div><div class="line">        <span class="keyword">if</span>(find(u)!=find(v))<span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,min(Ans(u,lca),Ans(v,lca)));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/04/01/noip2013d1/" data-id="cjftq8nwf003ze0ke1abkjw7n" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NOIP/">NOIP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lca/">lca</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/倍增/">倍增</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/归并排序/">归并排序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/快速幂/">快速幂</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最小生成树/">最小生成树</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树状数组/">树状数组</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模拟/">模拟</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/逆序对/">逆序对</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/">信息学竞赛</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/其它/">其它</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/总结/">总结</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/我的文档/">我的文档</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/考试/">考试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/题目/">题目</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/信息学竞赛/题目/模板/">模板</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/其它/">其它</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数学/">数学</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/数学/线性代数/">线性代数</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解决方案/">解决方案</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解决方案/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/解决方案/LaTeX/">LaTeX</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/解决方案/VSCode/">VSCode</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2-SAT/">2-SAT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anti-SG/">Anti-SG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Beatty定理/">Beatty定理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDQ分治/">CDQ分治</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CodeForces/">CodeForces</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Debug/">Debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Every-SG/">Every-SG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Floyd/">Floyd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ICG/">ICG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LaTeX/">LaTeX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lasker-s-Nim/">Lasker's Nim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Link-Cut-Tree/">Link-Cut-Tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Matrix-Tree/">Matrix-Tree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misere-Games/">Misère Games</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Multi-SG/">Multi-SG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NOIP/">NOIP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SDOI/">SDOI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SG函数/">SG函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tarjan/">Tarjan</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TikZ/">TikZ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Trie/">Trie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zeckendorf定理/">Zeckendorf定理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bfs/">bfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/copyright/">copyright</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/document/">document</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lca/">lca</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nim/">nim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pb-ds/">pb_ds</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pdf/">pdf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/source/">source</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/with-draw/">with draw</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/一堆简单题/">一堆简单题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/三维偏序/">三维偏序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二分/">二分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二分答案/">二分答案</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二维前缀和/">二维前缀和</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二维线段树/">二维线段树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/二进制拆分/">二进制拆分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/位运算/">位运算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/倍增/">倍增</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存池/">内存池</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/决策单调性/">决策单调性</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分块/">分块</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分数规划/">分数规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前缀和/">前缀和</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态规划/">动态规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/区间dp/">区间dp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单调栈/">单调栈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单调队列/">单调队列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博弈论/">博弈论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后缀数组/">后缀数组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/四边形不等式优化/">四边形不等式优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/回文串/">回文串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图论/">图论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基环树/">基环树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/堆优化Dijkstra/">堆优化Dijkstra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多重标记/">多重标记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多重背包/">多重背包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/威佐夫博弈/">威佐夫博弈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符串/">字符串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/差分约束/">差分约束</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/巴什博弈/">巴什博弈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/带权并查集/">带权并查集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/平衡树/">平衡树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并查集/">并查集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/异或/">异或</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/强制在线/">强制在线</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/强联通分量/">强联通分量</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/归并排序/">归并排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/快速幂/">快速幂</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/打表/">打表</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/扩展欧几里得/">扩展欧几里得</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/拆点/">拆点</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/拓扑排序/">拓扑排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/指针/">指针</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排列组合/">排列组合</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/搜索/">搜索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学/">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数论/">数论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/斐波那契博弈/">斐波那契博弈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/斐波那契数列/">斐波那契数列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/斜率优化/">斜率优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/无限/">无限</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最大公约数/">最大公约数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最大流/">最大流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最小生成树/">最小生成树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最短路/">最短路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最长上升子序列/">最长上升子序列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/最长公共子序列/">最长公共子序列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/构造/">构造</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/查分/">查分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树/">树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树形dp/">树形dp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树状数组/">树状数组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模拟/">模拟</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板/">模板</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/欧拉函数/">欧拉函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/测试/">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/版权信息/">版权信息</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生成树/">生成树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/矩阵快速幂/">矩阵快速幂</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/秦九韶算法/">秦九韶算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/等差数列/">等差数列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线性代数/">线性代数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线段树/">线段树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络流/">网络流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/考试/">考试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/背包/">背包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/艺术/">艺术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/莫比乌斯反演/">莫比乌斯反演</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/规律/">规律</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/解决方案/">解决方案</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计划/">计划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/贪心/">贪心</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/逆元/">逆元</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/逆序对/">逆序对</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/错位排列数/">错位排列数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/题目/">题目</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高精/">高精</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/2-SAT/" style="font-size: 10px;">2-SAT</a> <a href="/tags/Anti-SG/" style="font-size: 10px;">Anti-SG</a> <a href="/tags/Beatty定理/" style="font-size: 11.25px;">Beatty定理</a> <a href="/tags/CDQ分治/" style="font-size: 10px;">CDQ分治</a> <a href="/tags/CodeForces/" style="font-size: 10px;">CodeForces</a> <a href="/tags/Debug/" style="font-size: 10px;">Debug</a> <a href="/tags/Every-SG/" style="font-size: 10px;">Every-SG</a> <a href="/tags/Floyd/" style="font-size: 10px;">Floyd</a> <a href="/tags/Hexo/" style="font-size: 12.5px;">Hexo</a> <a href="/tags/ICG/" style="font-size: 11.25px;">ICG</a> <a href="/tags/LaTeX/" style="font-size: 10px;">LaTeX</a> <a href="/tags/Lasker-s-Nim/" style="font-size: 10px;">Lasker's Nim</a> <a href="/tags/Link-Cut-Tree/" style="font-size: 10px;">Link-Cut-Tree</a> <a href="/tags/Matrix-Tree/" style="font-size: 10px;">Matrix-Tree</a> <a href="/tags/Misere-Games/" style="font-size: 10px;">Misère Games</a> <a href="/tags/Multi-SG/" style="font-size: 11.25px;">Multi-SG</a> <a href="/tags/NOIP/" style="font-size: 17.5px;">NOIP</a> <a href="/tags/Python/" style="font-size: 11.25px;">Python</a> <a href="/tags/SDOI/" style="font-size: 10px;">SDOI</a> <a href="/tags/SG函数/" style="font-size: 10px;">SG函数</a> <a href="/tags/Tarjan/" style="font-size: 10px;">Tarjan</a> <a href="/tags/TikZ/" style="font-size: 10px;">TikZ</a> <a href="/tags/Trie/" style="font-size: 12.5px;">Trie</a> <a href="/tags/Zeckendorf定理/" style="font-size: 10px;">Zeckendorf定理</a> <a href="/tags/bfs/" style="font-size: 10px;">bfs</a> <a href="/tags/copyright/" style="font-size: 10px;">copyright</a> <a href="/tags/document/" style="font-size: 12.5px;">document</a> <a href="/tags/lca/" style="font-size: 10px;">lca</a> <a href="/tags/nim/" style="font-size: 11.25px;">nim</a> <a href="/tags/pb-ds/" style="font-size: 10px;">pb_ds</a> <a href="/tags/pdf/" style="font-size: 16.25px;">pdf</a> <a href="/tags/source/" style="font-size: 10px;">source</a> <a href="/tags/with-draw/" style="font-size: 11.25px;">with draw</a> <a href="/tags/一堆简单题/" style="font-size: 10px;">一堆简单题</a> <a href="/tags/三维偏序/" style="font-size: 10px;">三维偏序</a> <a href="/tags/二分/" style="font-size: 10px;">二分</a> <a href="/tags/二分答案/" style="font-size: 11.25px;">二分答案</a> <a href="/tags/二维前缀和/" style="font-size: 10px;">二维前缀和</a> <a href="/tags/二维线段树/" style="font-size: 10px;">二维线段树</a> <a href="/tags/二进制拆分/" style="font-size: 10px;">二进制拆分</a> <a href="/tags/位运算/" style="font-size: 10px;">位运算</a> <a href="/tags/倍增/" style="font-size: 13.75px;">倍增</a> <a href="/tags/内存池/" style="font-size: 11.25px;">内存池</a> <a href="/tags/决策单调性/" style="font-size: 10px;">决策单调性</a> <a href="/tags/分块/" style="font-size: 11.25px;">分块</a> <a href="/tags/分数规划/" style="font-size: 11.25px;">分数规划</a> <a href="/tags/前缀和/" style="font-size: 10px;">前缀和</a> <a href="/tags/动态规划/" style="font-size: 20px;">动态规划</a> <a href="/tags/区间dp/" style="font-size: 10px;">区间dp</a> <a href="/tags/单调栈/" style="font-size: 10px;">单调栈</a> <a href="/tags/单调队列/" style="font-size: 11.25px;">单调队列</a> <a href="/tags/博弈论/" style="font-size: 18.75px;">博弈论</a> <a href="/tags/后缀数组/" style="font-size: 11.25px;">后缀数组</a> <a href="/tags/四边形不等式优化/" style="font-size: 10px;">四边形不等式优化</a> <a href="/tags/回文串/" style="font-size: 10px;">回文串</a> <a href="/tags/图论/" style="font-size: 13.75px;">图论</a> <a href="/tags/基环树/" style="font-size: 10px;">基环树</a> <a href="/tags/堆优化Dijkstra/" style="font-size: 10px;">堆优化Dijkstra</a> <a href="/tags/多重标记/" style="font-size: 10px;">多重标记</a> <a href="/tags/多重背包/" style="font-size: 10px;">多重背包</a> <a href="/tags/威佐夫博弈/" style="font-size: 11.25px;">威佐夫博弈</a> <a href="/tags/字符串/" style="font-size: 15px;">字符串</a> <a href="/tags/差分约束/" style="font-size: 11.25px;">差分约束</a> <a href="/tags/巴什博弈/" style="font-size: 10px;">巴什博弈</a> <a href="/tags/带权并查集/" style="font-size: 10px;">带权并查集</a> <a href="/tags/平衡树/" style="font-size: 11.25px;">平衡树</a> <a href="/tags/并查集/" style="font-size: 10px;">并查集</a> <a href="/tags/异或/" style="font-size: 11.25px;">异或</a> <a href="/tags/强制在线/" style="font-size: 10px;">强制在线</a> <a href="/tags/强联通分量/" style="font-size: 10px;">强联通分量</a> <a href="/tags/归并排序/" style="font-size: 10px;">归并排序</a> <a href="/tags/快速幂/" style="font-size: 10px;">快速幂</a> <a href="/tags/打表/" style="font-size: 10px;">打表</a> <a href="/tags/扩展欧几里得/" style="font-size: 10px;">扩展欧几里得</a> <a href="/tags/拆点/" style="font-size: 10px;">拆点</a> <a href="/tags/拓扑排序/" style="font-size: 10px;">拓扑排序</a> <a href="/tags/指针/" style="font-size: 12.5px;">指针</a> <a href="/tags/排列组合/" style="font-size: 10px;">排列组合</a> <a href="/tags/搜索/" style="font-size: 16.25px;">搜索</a> <a href="/tags/数学/" style="font-size: 10px;">数学</a> <a href="/tags/数论/" style="font-size: 10px;">数论</a> <a href="/tags/斐波那契博弈/" style="font-size: 10px;">斐波那契博弈</a> <a href="/tags/斐波那契数列/" style="font-size: 10px;">斐波那契数列</a> <a href="/tags/斜率优化/" style="font-size: 11.25px;">斜率优化</a> <a href="/tags/无限/" style="font-size: 10px;">无限</a> <a href="/tags/最大公约数/" style="font-size: 10px;">最大公约数</a> <a href="/tags/最大流/" style="font-size: 10px;">最大流</a> <a href="/tags/最小生成树/" style="font-size: 11.25px;">最小生成树</a> <a href="/tags/最短路/" style="font-size: 16.25px;">最短路</a> <a href="/tags/最长上升子序列/" style="font-size: 11.25px;">最长上升子序列</a> <a href="/tags/最长公共子序列/" style="font-size: 10px;">最长公共子序列</a> <a href="/tags/构造/" style="font-size: 11.25px;">构造</a> <a href="/tags/查分/" style="font-size: 10px;">查分</a> <a href="/tags/树/" style="font-size: 10px;">树</a> <a href="/tags/树形dp/" style="font-size: 16.25px;">树形dp</a> <a href="/tags/树状数组/" style="font-size: 11.25px;">树状数组</a> <a href="/tags/模拟/" style="font-size: 17.5px;">模拟</a> <a href="/tags/模板/" style="font-size: 16.25px;">模板</a> <a href="/tags/欧拉函数/" style="font-size: 10px;">欧拉函数</a> <a href="/tags/测试/" style="font-size: 11.25px;">测试</a> <a href="/tags/版权信息/" style="font-size: 10px;">版权信息</a> <a href="/tags/生成树/" style="font-size: 13.75px;">生成树</a> <a href="/tags/矩阵快速幂/" style="font-size: 11.25px;">矩阵快速幂</a> <a href="/tags/秦九韶算法/" style="font-size: 10px;">秦九韶算法</a> <a href="/tags/等差数列/" style="font-size: 10px;">等差数列</a> <a href="/tags/线性代数/" style="font-size: 11.25px;">线性代数</a> <a href="/tags/线段树/" style="font-size: 17.5px;">线段树</a> <a href="/tags/网络流/" style="font-size: 10px;">网络流</a> <a href="/tags/考试/" style="font-size: 10px;">考试</a> <a href="/tags/背包/" style="font-size: 11.25px;">背包</a> <a href="/tags/艺术/" style="font-size: 11.25px;">艺术</a> <a href="/tags/莫比乌斯反演/" style="font-size: 11.25px;">莫比乌斯反演</a> <a href="/tags/规律/" style="font-size: 11.25px;">规律</a> <a href="/tags/解决方案/" style="font-size: 15px;">解决方案</a> <a href="/tags/计划/" style="font-size: 13.75px;">计划</a> <a href="/tags/贪心/" style="font-size: 15px;">贪心</a> <a href="/tags/逆元/" style="font-size: 10px;">逆元</a> <a href="/tags/逆序对/" style="font-size: 10px;">逆序对</a> <a href="/tags/错位排列数/" style="font-size: 10px;">错位排列数</a> <a href="/tags/题目/" style="font-size: 10px;">题目</a> <a href="/tags/高精/" style="font-size: 11.25px;">高精</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/04/10/dphigher/">动态规划题目选做</a>
          </li>
        
          <li>
            <a href="/2018/04/10/dpeasypros/">历年NOIP简单动态规划题目选做</a>
          </li>
        
          <li>
            <a href="/2018/04/07/noip2014d2/">NOIP 2014 Day1</a>
          </li>
        
          <li>
            <a href="/2018/04/07/noip2014d1/">NOIP 2014 Day1</a>
          </li>
        
          <li>
            <a href="/2018/04/06/SuffixArray/">后缀数组</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>